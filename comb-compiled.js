(function(){var v,w,x,y,z,O,p,P,F,Q,s,G,H,R,I,S,l,f,A,a,j,J,T,K,B,U,C,c,D,u,L,M,V,W,E,e,t,N,X=Object.prototype.hasOwnProperty,k=function(c,b){function m(){this.constructor=c}for(var a in b)X.call(b,a)&&(c[a]=b[a]);m.prototype=b.prototype;c.prototype=new m;c.__super__=b.prototype;return c};p=function(){function c(b,m){this.x=b;this.y=m}c.prototype.boxHit=function(b){return Math.abs(b.x-this.x)<(b.width+this.width)/2&&Math.abs(b.y-this.y)<(b.height+this.height)/2};c.prototype.offscreen=function(){return 0>
this.x||this.x>f.width||0>this.y||this.y>f.height};c.prototype.drawAsBox=function(){return a.fillRect(this.x-this.width/2,this.y-this.height/2,this.width,this.height)};return c}();z=function(c){function b(b,c,a,d,e){this.x=b;this.y=c;this.speed=a;this.cooldown=d;this.owner=e}k(b,c);b.prototype.width=4;b.prototype.height=4;b.prototype.speed=12;b.prototype.move=function(){return this.y+=this.speed};b.prototype.explode=function(){var b;return this.owner.shrapnals=this.owner.shrapnals.concat(function(){var c;
c=[];for(b=0;9>=b;b++)c.push(new I(this.x,this.y,36*b*Math.PI/180,I.prototype.speed,this.owner));return c}.call(this))};b.prototype.draw=function(){a.fillStyle=this.owner.color;return this.drawAsBox()};b.prototype.update=function(){this.cooldown-=1;0>=this.cooldown&&this.explode();this.move();return this.draw()};return b}(p);G=function(c){function b(b,c){this.x=b;this.y=c;this.used=0}k(b,c);b.prototype.move=function(){return this.y+=this.speed};b.prototype.draw=function(){a.fillStyle=this.color;return this.drawAsBox()};
b.prototype.detectUse=function(){this.boxHit(e)&&(this.used=1,this.use());if(this.offscreen())return this.used=1};b.prototype.update=function(){this.move();this.draw();return this.detectUse()};return b}(p);F=function(a){function b(c,a){this.x=c;this.y=a;b.__super__.constructor.call(this,this.x,this.y)}k(b,a);b.prototype.rand=0.05;b.prototype.width=4;b.prototype.height=4;b.prototype.speed=5;b.prototype.color="#00FF00";b.prototype.use=function(){c.owners.player.health=Math.min(c.owners.player.health+
15,100);return c.timers.dispHealth=255};return b}(G);H=function(a){function b(c,a){this.x=c;this.y=a;b.__super__.constructor.call(this,this.x,this.y)}k(b,a);b.prototype.rand=0.1;b.prototype.width=4;b.prototype.height=4;b.prototype.speed=5;b.prototype.color="#0088FF";b.prototype.use=function(){c.owners.player.shield=Math.min(c.owners.player.shield+200,4E3);return c.timers.dispHealth=255};return b}(G);R=function(){function d(b,c){this.x=b;this.y=c;this.heat=this.bombCooldown=this.laserCooldown=0}d.prototype.width=
40;d.prototype.height=40;d.prototype.boxHit=function(b){return Math.abs(b.x-this.x)<(b.width+this.width)/2&&Math.abs(b.y-this.y)<(b.height+this.height)/2};d.prototype.move=function(){this.x=(this.x+v)/2;return this.y=(this.y+w)/2};d.prototype.drawShield=function(){a.strokeStyle="rgb(0,".concat(Math.floor(c.timers.colorCycle/2),",",c.timers.colorCycle,")");a.beginPath();a.arc(this.x,this.y,Math.min(this.width,this.height),0,2*Math.PI,!1);return a.stroke()};d.prototype.draw=function(){0<c.owners.player.shield&&
this.drawShield();a.strokeStyle="#FFFFFF";a.beginPath();a.moveTo(this.x,this.y-this.height/2);a.quadraticCurveTo(this.x+this.width/2,this.y,this.x+this.width/2,this.y+this.height/2);a.quadraticCurveTo(this.x+this.width/8,this.y+this.height/4,this.x,this.y+this.height/4);a.quadraticCurveTo(this.x-this.width/8,this.y+this.height/4,this.x-this.width/2,this.y+this.height/2);a.quadraticCurveTo(this.x-this.width/2,this.y,this.x,this.y-this.height/2);a.closePath();return a.stroke()};d.prototype.damage=function(b){c.timers.dispHealth=
255;c.owners.player.shield-=20*b;if(0>c.owners.player.shield)return c.owners.player.health+=Math.floor(c.owners.player.shield/20),c.owners.player.shield=0};d.prototype.takeDamage=function(){var b,a,d,g,e;g=c.owners.enemies.lasers;a=0;for(d=g.length;a<d;a++)b=g[a],Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2&&(b.killedSomething=!0,this.damage(8));g=c.owners.enemies.bombs;a=0;for(d=g.length;a<d;a++)b=g[a],this.boxHit(b)&&(b.cooldown=
0,this.damage(2));g=c.owners.enemies.shrapnals;e=[];a=0;for(d=g.length;a<d;a++)b=g[a],this.boxHit(b)?(b.cooldown=0,e.push(this.damage(2))):e.push(void 0);return e};d.prototype.update=function(){this.move();this.draw();this.takeDamage();return c.owners.player.shield=Math.max(c.owners.player.shield-1,0)};return d}();O=function(d){function b(b,c){this.x=b;this.y=c;this.bombCooldown=this.angle=0;this.turnVel=(Math.random()-0.5)/30;this.health=1}k(b,d);b.prototype.rand=0.01;b.prototype.threshold=30;b.prototype.width=
10;b.prototype.height=28;b.prototype.move=function(){this.x+=2*Math.cos(this.angle+Math.PI/2);this.y+=2*Math.sin(this.angle+Math.PI/2);this.angle+=this.turnVel;return this.goneOnScreen=0};b.prototype.draw=function(){a.translate(this.x,this.y);a.rotate(this.angle);a.beginPath();a.moveTo(0,this.height/2);a.lineTo(this.width/2,0);a.lineTo(0,-this.height/2);a.lineTo(-this.width/2,0);a.closePath();a.stroke();a.rotate(-this.angle);return a.translate(-this.x,-this.y)};b.prototype.bomb=function(){this.bombCooldown=
40;return c.owners.enemies.bombs.push(new z(this.x,this.y,4,35,c.owners.enemies))};b.prototype.takeDamage=function(){var b,a,d,f;if(this.offscreen()){if(this.goneOnScreen)return this.health=0}else this.goneOnScreen=1;if(this.boxHit(e))return e.damage(24),c.owners.player.kills+=1,this.health=0;f=c.owners.player.lasers;a=0;for(d=f.length;a<d;a++)if(b=f[a],Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2)return b.killedSomething=!0,c.owners.player.kills+=
1,this.health=0;f=c.owners.player.bombs;a=0;for(d=f.length;a<d;a++)if(b=f[a],this.boxHit(b))return b.cooldown=0,c.owners.player.kills+=1,this.health=0;f=c.owners.player.shrapnals;a=0;for(d=f.length;a<d;a++)if(b=f[a],this.boxHit(b))return c.owners.player.kills+=1,this.health=0};b.prototype.update=function(){0===this.bombCooldown&&this.bomb();this.bombCooldown-=1;this.move();this.draw();return this.takeDamage()};return b}(p);Q=function(d){function b(b,c){this.x=b;this.y=c;this.moveState=this.shootCooldown=
this.angle=0;this.health=1}k(b,d);b.prototype.rand=0.02;b.prototype.threshold=15;b.prototype.width=20;b.prototype.height=20;b.prototype.move=function(){var b;switch(this.moveState){case 0:if(150>Math.abs(this.x-e.x)&&150>Math.abs(this.y-e.y))return this.moveState=1;this.angle=0;return this.y+=1;case 1:return b=this.y>e.y?Math.PI-Math.atan((this.x-e.x)/(this.y-e.y)):-Math.atan((this.x-e.x)/(this.y-e.y)),Math.abs(b-this.angle)<Math.PI/24||Math.abs(b-this.angle)>2*Math.PI-Math.PI/24?(this.angle=b,this.moveState=
2):this.angle<b&&this.angle-b<Math.PI||2*Math.PI-this.angle-b<Math.PI?this.angle+=Math.PI/24:this.angle-=Math.PI/24;case 2:return this.x+=30*Math.cos(this.angle+Math.PI/2),this.y+=30*Math.sin(this.angle+Math.PI/2)}};b.prototype.draw=function(){a.translate(this.x,this.y);a.rotate(this.angle);a.beginPath();a.moveTo(-this.width/2,-this.height/2);a.lineTo(this.width/2,-this.height/2);a.lineTo(this.width/2,this.height/5);a.lineTo(0,this.height/2);a.lineTo(-this.width/2,this.height/5);a.closePath();a.stroke();
a.rotate(-this.angle);return a.translate(-this.x,-this.y)};b.prototype.takeDamage=function(){var b,a,d,i;if(this.y>f.height||this.moveState&&this.offscreen())return this.health=0;if(this.boxHit(e))return c.owners.player.kills+=1,e.damage(35),this.health=0;i=c.owners.player.lasers;a=0;for(d=i.length;a<d;a++)if(b=i[a],Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2)return b.killedSomething=!0,c.owners.player.kills+=1,this.health=0;i=c.owners.player.bombs;
a=0;for(d=i.length;a<d;a++)if(b=i[a],this.boxHit(b))return b.cooldown=0,c.owners.player.kills+=1,this.health=0;i=c.owners.player.shrapnals;a=0;for(d=i.length;a<d;a++)if(b=i[a],this.boxHit(b))return c.owners.player.kills+=1,this.health=0};b.prototype.update=function(){this.move();this.draw();return this.takeDamage()};return b}(p);I=function(){function c(b,a,d,e,f){this.x=b;this.y=a;this.angle=d;this.speed=e;this.owner=f;this.cooldown=10}c.prototype.speed=10;c.prototype.width=2;c.prototype.height=2;
c.prototype.drawAsBox=function(){return a.fillRect(this.x-this.width/2,this.y-this.height/2,this.width,this.height)};c.prototype.move=function(){this.x+=this.speed*Math.cos(this.angle);return this.y+=this.speed*Math.sin(this.angle)};c.prototype.draw=function(){a.fillStyle=this.owner.color;return this.drawAsBox()};c.prototype.update=function(){this.cooldown-=1;this.move();return this.draw()};return c}();P=function(){function d(b,c){this.x=b;this.y=c;this.shootCooldown=0;this.health=1}d.prototype.rand=
0.03;d.prototype.threshold=0;d.prototype.width=20;d.prototype.height=20;d.prototype.boxHit=function(b){return Math.abs(b.x-this.x)<(b.width+this.width)/2&&Math.abs(b.y-this.y)<(b.height+this.height)/2};d.prototype.draw=function(){a.strokeStyle="#FFFFFF";a.beginPath();a.moveTo(this.x-this.width/2,this.y-this.height/2);a.lineTo(this.x+this.width/2,this.y-this.height/2);a.lineTo(this.x,this.y+this.height/2);a.closePath();return a.stroke()};d.prototype.move=function(){var b;this.y+=3;b=(e.x-this.x)/12;
return this.x+=5>Math.abs(b)?b:5*b/Math.abs(b)};d.prototype.shoot=function(){this.shootCooldown=35;return c.owners.enemies.lasers.push(new s(this.x,this.y,s.prototype.speed,c.owners.enemies))};d.prototype.takeDamage=function(){var b,a,d,g;if(this.y>f.height)return this.health=0;if(this.boxHit(e))return e.damage(24),c.owners.player.kills+=1,this.health=0;g=c.owners.player.lasers;a=0;for(d=g.length;a<d;a++)if(b=g[a],Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+
b.height)/2+this.height/2)return b.killedSomething=!0,c.owners.player.kills+=1,this.health=0;g=c.owners.player.bombs;a=0;for(d=g.length;a<d;a++)if(b=g[a],this.boxHit(b))return b.cooldown=0,c.owners.player.kills+=1,this.health=0;g=c.owners.player.shrapnals;a=0;for(d=g.length;a<d;a++)if(b=g[a],this.boxHit(b))return c.owners.player.kills+=1,this.health=0};d.prototype.update=function(){0===this.shootCooldown&&this.shoot();this.shootCooldown-=1;this.move();this.draw();return this.takeDamage()};return d}();
s=function(){function c(b,a,d,e){this.x=b;this.y=a;this.speed=d;this.owner=e;this.killedSomething=!1}c.prototype.speed=20;c.prototype.width=2;c.prototype.height=16;c.prototype.drawAsBox=function(){return a.fillRect(this.x-this.width/2,this.y-this.height/2,this.width,this.height)};c.prototype.draw=function(){a.fillStyle=this.owner.color;return this.drawAsBox()};c.prototype.move=function(){return this.y+=this.speed};c.prototype.update=function(){this.move();return this.draw()};return c}();S=function(){function d(b,
c){this.x=b;this.y=c;this.burst=this.shootCooldown=this.angle=0;this.health=1}d.prototype.rand=0.005;d.prototype.threshold=45;d.prototype.width=20;d.prototype.height=20;d.prototype.boxHit=function(b){return Math.abs(b.x-this.x)<(b.width+this.width)/2&&Math.abs(b.y-this.y)<(b.height+this.height)/2};d.prototype.draw=function(){a.translate(this.x,this.y);a.rotate(this.angle);a.beginPath();a.moveTo(-this.width/2,-this.height/2);a.lineTo(this.width/2,-this.height/2);a.lineTo(this.width/2,this.height/2);
a.lineTo(-this.width/2,this.height/2);a.closePath();a.stroke();a.rotate(-this.angle);return a.translate(-this.x,-this.y)};d.prototype.move=function(){this.angle+=0.1;return this.y+=2};d.prototype.shoot=function(){5>this.burst?this.burst+=1:(this.shootCooldown=55,this.burst=0);return c.owners.enemies.lasers.push(new s(this.x,this.y,s.prototype.speed,c.owners.enemies))};d.prototype.takeDamage=function(){var b,a,d,g;if(this.y>f.height)return this.health=0;if(this.boxHit(e))return e.damage(24),c.owners.player.kills+=
1,this.health=0;g=c.owners.player.lasers;a=0;for(d=g.length;a<d;a++)if(b=g[a],Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2)return b.killedSomething=!0,c.owners.player.kills+=1,this.health=0;g=c.owners.player.bombs;a=0;for(d=g.length;a<d;a++)if(b=g[a],this.boxHit(b))return b.cooldown=0,c.owners.player.kills+=1,this.health=0;g=c.owners.player.shrapnals;a=0;for(d=g.length;a<d;a++)if(b=g[a],this.boxHit(b))return c.owners.player.kills+=
1,this.health=0};d.prototype.update=function(){0>=this.shootCooldown&&this.shoot();this.shootCooldown-=1;this.move();this.draw();return this.takeDamage()};return d}();u=function(a){if(c.owners.player.kills>=a.prototype.threshold&&Math.random()<a.prototype.rand)return c.owners.enemies.units.push(new a(V(0,f.width),-10))};f=document.getElementById("c");a=f.getContext("2d");l=$("<audio></audio>").attr({loop:"loop"}).append($("<source></source>").attr({src:"media/tonight_full.ogg"}).attr({type:"audio/ogg"})).append($("<source></source>").attr({src:"media/tonight_full.mp3"}).attr({type:"audio/mpeg"})).appendTo("body")[0];
console.log(l);if(!a)throw"Loading context failed";V=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};B=function(a,b){return setInterval(b,a)};e=c=void 0;C=!0;v=250;w=200;y=x=!1;t=void 0;j="Title";E=function(){a.fillStyle="#FFFFFF";a.font="bold 20px Lucidia Console";a.textAlign="center";return a.textBaseline="middle"};W=function(){a.fillStyle="#FFFFFF";a.font="normal 18px Lucidia Console";a.textAlign="left";return a.textBaseline="bottom"};A=function(){a.fillStyle="#000000";return a.fillRect(0,
0,f.width,f.height)};K=function(){A();E();a.fillText("Tempus [Dev]",f.width/2,f.height/2-12);a.fillText("Click to play",f.width/2,f.height/2+12);W();return a.fillText("by Jake Stothard",10,f.height-10)};T=function(){A();E();a.fillText("Game Over",f.width/2,f.height/2-20);a.font="normal 18px Lucidia Console";a.fillText("Kills - "+c.owners.player.kills,f.width/2,f.height/2);a.fillText("Lasers Fired - "+c.owners.player.lasersFired,f.width/2,f.height/2+20);return a.fillText("Bombs Used - "+c.owners.player.bombsFired,
f.width/2,f.height/2+40)};a.strokeStyle="#FFFFFF";a.lineWidth=4;U=function(){$("#enableMusic")[0].checked&&l.play();return C=!1};L=function(){C&&U();e=new R(v,w);return c={owners:{player:{lasers:[],bombs:[],shrapnals:[],units:e,color:"#0044FF",health:100,shield:0,kills:0,lasersFired:0,bombsFired:0},enemies:{lasers:[],bombs:[],shrapnals:[],units:[],color:"#FF0000"}},timers:{dispHealth:0,colorCycle:0,colorCycleDir:10},powerups:{healthups:[],shieldups:[]},crashed:!1}};J=function(){a.strokeStyle="rgb(0,".concat(c.timers.dispHealth,
",0)");a.beginPath();a.arc(f.width/2,f.height/2,Math.min(f.width,f.height)/2-20,0,2*Math.max(c.owners.player.health,0)*Math.PI/100,!1);a.stroke();a.strokeStyle="rgb(0,".concat(Math.floor(c.timers.dispHealth/2),",",c.timers.dispHealth,")");a.beginPath();a.arc(f.width/2,f.height/2,Math.min(f.width,f.height)/2-40,0,2*Math.max(c.owners.player.shield,0)*Math.PI/4E3,!1);return a.stroke()};M=function(){j="Paused";clearInterval(t);J();E();return a.fillText("[Paused]",f.width/2,f.height/2)};N=function(){j=
"Playing";return t=B(32,D)};$(document).keyup(function(a){switch(a.which){case 80:switch(j){case "Paused":return N();case "Playing":return M()}}});$("#c").mousemove(function(a){v=a.pageX-this.offsetLeft;return w=a.pageY-this.offsetTop}).mouseout(function(){if("Playing"===j)return M()}).mousedown(function(a){switch(a.which){case 1:return x=!0;case 3:return y=!0}}).mouseup(function(a){switch(a.which){case 1:return x=!1;case 3:return y=!1}}).click(function(){switch(j){case "Paused":return N();case "Title":return j=
"Playing",L(),t=B(32,D);case void 0:return j="Title",K()}}).bind("contextmenu",function(){return!1});$("#enableMusic").change(function(){if(!C){if($("#enableMusic")[0].checked)return l.play(),!0;l.pause();return!1}});D=function(){var d,b,m,o,g,i,k,p,l,n,h,q,r;if(c.crashed)j="Crashed",clearInterval(t);else{c.crashed=!0;c.timers.colorCycle+=c.timers.colorCycleDir;c.timers.colorCycle=Math.min(c.timers.colorCycle,255);c.timers.colorCycle=Math.max(c.timers.colorCycle,0);if(0===c.timers.colorCycle||255===
c.timers.colorCycle)c.timers.colorCycleDir*=-1;if(0>=c.owners.player.health)j=void 0,clearInterval(t),T();else{A();q=c.owners.enemies.units;n=0;for(h=q.length;n<h;n++)b=q[n],b.update();c.powerups.healthups=c.powerups.healthups.concat(function(){var a,d,e,f;e=c.owners.enemies.units;f=[];a=0;for(d=e.length;a<d;a++)b=e[a],0>=b.health&&Math.random()<F.prototype.rand&&f.push(new F(b.x,b.y));return f}());c.powerups.shieldups=c.powerups.shieldups.concat(function(){var a,d,e,f;e=c.owners.enemies.units;f=
[];a=0;for(d=e.length;a<d;a++)b=e[a],0>=b.health&&Math.random()<H.prototype.rand&&f.push(new H(b.x,b.y));return f}());c.owners.enemies.units=function(){var a,d,e,f;e=c.owners.enemies.units;f=[];a=0;for(d=e.length;a<d;a++)b=e[a],0<b.health&&f.push(b);return f}();u(P);u(Q);u(O);u(S);e.update();n=c.owners;for(g in n){o=n[g];r=o.lasers;h=0;for(q=r.length;h<q;h++)m=r[h],m.update();o.lasers=function(){var a,b,c,d,e;c=o.lasers;e=[];a=0;for(b=c.length;a<b;a++)m=c[a],0<(d=m.y)&&d<f.height&&!m.killedSomething&&
e.push(m);return e}();r=o.bombs;h=0;for(q=r.length;h<q;h++)d=r[h],d.update();o.bombs=function(){var a,b,c,e;c=o.bombs;e=[];a=0;for(b=c.length;a<b;a++)d=c[a],0<d.cooldown&&e.push(d);return e}();r=o.shrapnals;h=0;for(q=r.length;h<q;h++)l=r[h],l.update();o.shrapnals=function(){var a,b,c,d;c=o.shrapnals;d=[];b=0;for(a=c.length;b<a;b++)l=c[b],0<l.cooldown&&d.push(l);return d}()}h=c.powerups;for(p in h){k=h[p];n=0;for(g=k.length;n<g;n++)i=k[n],i.update();c.powerups[p]=function(){var a,b,c;c=[];b=0;for(a=
k.length;b<a;b++)i=k[b],i.used||c.push(i);return c}()}x&&0>=e.laserCooldown&&(c.owners.player.lasersFired+=1,c.owners.player.lasers.push(new s(e.x,e.y,-s.prototype.speed,c.owners.player)),e.laserCooldown=80<e.heat?7:40<e.heat?5:2,e.heat+=7);y&&0>=e.bombCooldown&&(c.owners.player.bombsFired+=1,"Playing"===j&&c.owners.player.bombs.push(new z(e.x,e.y,-z.prototype.speed,20,c.owners.player)),e.bombCooldown=80<e.heat?20:40<e.heat?10:5,e.heat+=10);0<e.laserCooldown&&(e.laserCooldown-=1);0<e.bombCooldown&&
(e.bombCooldown-=1);0<e.heat&&(e.heat-=1);a.textAlign="center";a.textBaseline="bottom";80<e.heat?(a.fillStyle="rgb(".concat(c.timers.colorCycle,",0,0)"),a.font="bold 20px Lucidia Console",a.fillText("[ Heat Critical ]",f.width/2,f.height-30)):40<e.heat&&(a.fillStyle="rgb(".concat(c.timers.colorCycle,",",c.timers.colorCycle,",0)"),a.font="normal 18px Lucidia Console",a.fillText("[ Heat Warning ]",f.width/2,f.height-30));0<c.timers.dispHealth&&(J(),a.strokeStyle="#FFFFFF",c.timers.dispHealth-=10);return c.crashed=
!1}}};switch(j){case "Playing":L();t=B(32,D);break;case "Title":K()}}).call(this);
