(function(){var v,w,x,y,z,N,k,O,G,P,r,Q,H,R,o,f,A,c,j,I,S,J,B,T,C,a,D,t,K,L,U,V,E,e,s,M,W=Object.prototype.hasOwnProperty,F=function(a,b){function l(){this.constructor=a}for(var c in b)W.call(b,c)&&(a[c]=b[c]);l.prototype=b.prototype;a.prototype=new l;a.__super__=b.prototype;return a};k=function(){function a(b,l){this.x=b;this.y=l}a.prototype.boxHit=function(b){return Math.abs(b.x-this.x)<(b.width+this.width)/2&&Math.abs(b.y-this.y)<(b.height+this.height)/2};a.prototype.offscreen=function(){return 0>
this.x||this.x>f.width||0>this.y||this.y>f.height};a.prototype.drawAsBox=function(){return c.fillRect(this.x-this.width/2,this.y-this.height/2,this.width,this.height)};return a}();z=function(a){function b(b,a,c,d,e){this.x=b;this.y=a;this.speed=c;this.cooldown=d;this.owner=e}F(b,a);b.prototype.width=4;b.prototype.height=4;b.prototype.speed=12;b.prototype.move=function(){return this.y+=this.speed};b.prototype.explode=function(){var b;return this.owner.shrapnals=this.owner.shrapnals.concat(function(){var a;
a=[];for(b=0;9>=b;b++)a.push(new H(this.x,this.y,36*b*Math.PI/180,H.prototype.speed,this.owner));return a}.call(this))};b.prototype.draw=function(){c.fillStyle=this.owner.color;return this.drawAsBox()};b.prototype.update=function(){this.cooldown-=1;0>=this.cooldown&&this.explode();this.move();return this.draw()};return b}(k);G=function(d){function b(b,a){this.x=b;this.y=a;this.used=0}F(b,d);b.prototype.rand=0.2;b.prototype.width=4;b.prototype.height=4;b.prototype.speed=5;b.prototype.move=function(){return this.y+=
this.speed};b.prototype.draw=function(){c.fillStyle="#00FF00";return this.drawAsBox()};b.prototype.detectUse=function(){this.boxHit(e)&&(console.log("Used"),this.used=1,a.owners.player.health=Math.min(a.owners.player.health+15,100),a.timers.dispHealth=255);this.offscreen()&&(this.used=1);if(this.offscreen())return console.log("Offscreen"),console.log(this.x),console.log(this.y),console.log(f.width),console.log(f.height)};b.prototype.update=function(){this.move();this.draw();return this.detectUse()};
return b}(k);Q=function(){function d(b,a){this.x=b;this.y=a;this.heat=this.bombCooldown=this.laserCooldown=0}d.prototype.width=40;d.prototype.height=40;d.prototype.boxHit=function(b){return Math.abs(b.x-this.x)<(b.width+this.width)/2&&Math.abs(b.y-this.y)<(b.height+this.height)/2};d.prototype.move=function(){this.x=(this.x+v)/2;return this.y=(this.y+w)/2};d.prototype.draw=function(){c.strokeStyle="#FFFFFF";c.beginPath();c.moveTo(this.x,this.y-this.height/2);c.quadraticCurveTo(this.x+this.width/2,
this.y,this.x+this.width/2,this.y+this.height/2);c.quadraticCurveTo(this.x+this.width/8,this.y+this.height/4,this.x,this.y+this.height/4);c.quadraticCurveTo(this.x-this.width/8,this.y+this.height/4,this.x-this.width/2,this.y+this.height/2);c.quadraticCurveTo(this.x-this.width/2,this.y,this.x,this.y-this.height/2);c.closePath();return c.stroke()};d.prototype.takeDamage=function(){var b,c,d,g,e;g=a.owners.enemies.lasers;c=0;for(d=g.length;c<d;c++)b=g[c],Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-
b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2&&(b.killedSomething=!0,a.owners.player.health-=8,a.timers.dispHealth=255);g=a.owners.enemies.bombs;c=0;for(d=g.length;c<d;c++)b=g[c],this.boxHit(b)&&(b.cooldown=0,a.owners.player.health-=2,a.timers.dispHealth=255);g=a.owners.enemies.shrapnals;e=[];c=0;for(d=g.length;c<d;c++)b=g[c],this.boxHit(b)?(b.cooldown=0,a.owners.player.health-=2,e.push(a.timers.dispHealth=255)):e.push(void 0);return e};d.prototype.update=function(){this.move();this.draw();
return this.takeDamage()};return d}();N=function(d){function b(b,a){this.x=b;this.y=a;this.bombCooldown=this.angle=0;this.turnVel=(Math.random()-0.5)/30;this.health=1}F(b,d);b.prototype.rand=0.01;b.prototype.threshold=30;b.prototype.width=10;b.prototype.height=28;b.prototype.move=function(){this.x+=2*Math.cos(this.angle+Math.PI/2);this.y+=2*Math.sin(this.angle+Math.PI/2);this.angle+=this.turnVel;return this.goneOnScreen=0};b.prototype.draw=function(){c.translate(this.x,this.y);c.rotate(this.angle);
c.beginPath();c.moveTo(0,this.height/2);c.lineTo(this.width/2,0);c.lineTo(0,-this.height/2);c.lineTo(-this.width/2,0);c.closePath();c.stroke();c.rotate(-this.angle);return c.translate(-this.x,-this.y)};b.prototype.bomb=function(){this.bombCooldown=40;return a.owners.enemies.bombs.push(new z(this.x,this.y,4,35,a.owners.enemies))};b.prototype.takeDamage=function(){var b,c,d,f;if(this.offscreen()){if(this.goneOnScreen)return this.health=0}else this.goneOnScreen=1;if(this.boxHit(e))return a.owners.player.health-=
24,a.owners.player.kills+=1,a.timers.dispHealth=255,this.health=0;f=a.owners.player.lasers;c=0;for(d=f.length;c<d;c++)if(b=f[c],Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2)return b.killedSomething=!0,a.owners.player.kills+=1,this.health=0;f=a.owners.player.bombs;c=0;for(d=f.length;c<d;c++)if(b=f[c],this.boxHit(b))return b.cooldown=0,a.owners.player.kills+=1,this.health=0;f=a.owners.player.shrapnals;c=0;for(d=f.length;c<d;c++)if(b=
f[c],this.boxHit(b))return a.owners.player.kills+=1,this.health=0};b.prototype.update=function(){0===this.bombCooldown&&this.bomb();this.bombCooldown-=1;this.move();this.draw();return this.takeDamage()};return b}(k);P=function(d){function b(b,a){this.x=b;this.y=a;this.moveState=this.shootCooldown=this.angle=0;this.health=1}F(b,d);b.prototype.rand=0.02;b.prototype.threshold=15;b.prototype.width=20;b.prototype.height=20;b.prototype.move=function(){var b;switch(this.moveState){case 0:if(150>Math.abs(this.x-
e.x)&&150>Math.abs(this.y-e.y))return this.moveState=1;this.angle=0;return this.y+=1;case 1:return b=this.y>e.y?Math.PI-Math.atan((this.x-e.x)/(this.y-e.y)):-Math.atan((this.x-e.x)/(this.y-e.y)),Math.abs(b-this.angle)<Math.PI/24||Math.abs(b-this.angle)>2*Math.PI-Math.PI/24?(this.angle=b,this.moveState=2):this.angle<b&&this.angle-b<Math.PI||2*Math.PI-this.angle-b<Math.PI?this.angle+=Math.PI/24:this.angle-=Math.PI/24;case 2:return this.x+=30*Math.cos(this.angle+Math.PI/2),this.y+=30*Math.sin(this.angle+
Math.PI/2)}};b.prototype.draw=function(){c.translate(this.x,this.y);c.rotate(this.angle);c.beginPath();c.moveTo(-this.width/2,-this.height/2);c.lineTo(this.width/2,-this.height/2);c.lineTo(this.width/2,this.height/5);c.lineTo(0,this.height/2);c.lineTo(-this.width/2,this.height/5);c.closePath();c.stroke();c.rotate(-this.angle);return c.translate(-this.x,-this.y)};b.prototype.takeDamage=function(){var b,c,d,i;if(this.y>f.height||this.moveState&&this.offscreen())return this.health=0;if(this.boxHit(e))return a.owners.player.kills+=
1,a.owners.player.health-=35,a.timers.dispHealth=255,this.health=0;i=a.owners.player.lasers;c=0;for(d=i.length;c<d;c++)if(b=i[c],Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2)return b.killedSomething=!0,a.owners.player.kills+=1,this.health=0;i=a.owners.player.bombs;c=0;for(d=i.length;c<d;c++)if(b=i[c],this.boxHit(b))return b.cooldown=0,a.owners.player.kills+=1,this.health=0;i=a.owners.player.shrapnals;c=0;for(d=i.length;c<d;c++)if(b=
i[c],this.boxHit(b))return a.owners.player.kills+=1,this.health=0};b.prototype.update=function(){this.move();this.draw();return this.takeDamage()};return b}(k);H=function(){function a(b,c,d,e,f){this.x=b;this.y=c;this.angle=d;this.speed=e;this.owner=f;this.cooldown=10}a.prototype.speed=10;a.prototype.width=2;a.prototype.height=2;a.prototype.drawAsBox=function(){return c.fillRect(this.x-this.width/2,this.y-this.height/2,this.width,this.height)};a.prototype.move=function(){this.x+=this.speed*Math.cos(this.angle);
return this.y+=this.speed*Math.sin(this.angle)};a.prototype.draw=function(){c.fillStyle=this.owner.color;return this.drawAsBox()};a.prototype.update=function(){this.cooldown-=1;this.move();return this.draw()};return a}();O=function(){function d(b,a){this.x=b;this.y=a;this.shootCooldown=0;this.health=1}d.prototype.rand=0.03;d.prototype.threshold=0;d.prototype.width=20;d.prototype.height=20;d.prototype.boxHit=function(b){return Math.abs(b.x-this.x)<(b.width+this.width)/2&&Math.abs(b.y-this.y)<(b.height+
this.height)/2};d.prototype.draw=function(){c.strokeStyle="#FFFFFF";c.beginPath();c.moveTo(this.x-this.width/2,this.y-this.height/2);c.lineTo(this.x+this.width/2,this.y-this.height/2);c.lineTo(this.x,this.y+this.height/2);c.closePath();return c.stroke()};d.prototype.move=function(){var b;this.y+=3;b=(e.x-this.x)/12;return this.x+=5>Math.abs(b)?b:5*b/Math.abs(b)};d.prototype.shoot=function(){this.shootCooldown=35;return a.owners.enemies.lasers.push(new r(this.x,this.y,r.prototype.speed,a.owners.enemies))};
d.prototype.takeDamage=function(){var b,c,d,g;if(this.y>f.height)return this.health=0;if(this.boxHit(e))return a.owners.player.health-=24,a.owners.player.kills+=1,a.timers.dispHealth=255,this.health=0;g=a.owners.player.lasers;c=0;for(d=g.length;c<d;c++)if(b=g[c],Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2)return b.killedSomething=!0,a.owners.player.kills+=1,this.health=0;g=a.owners.player.bombs;c=0;for(d=g.length;c<d;c++)if(b=g[c],
this.boxHit(b))return b.cooldown=0,a.owners.player.kills+=1,this.health=0;g=a.owners.player.shrapnals;c=0;for(d=g.length;c<d;c++)if(b=g[c],this.boxHit(b))return a.owners.player.kills+=1,this.health=0};d.prototype.update=function(){0===this.shootCooldown&&this.shoot();this.shootCooldown-=1;this.move();this.draw();return this.takeDamage()};return d}();r=function(){function a(b,c,d,e){this.x=b;this.y=c;this.speed=d;this.owner=e;this.killedSomething=!1}a.prototype.speed=20;a.prototype.width=2;a.prototype.height=
16;a.prototype.drawAsBox=function(){return c.fillRect(this.x-this.width/2,this.y-this.height/2,this.width,this.height)};a.prototype.draw=function(){c.fillStyle=this.owner.color;return this.drawAsBox()};a.prototype.move=function(){return this.y+=this.speed};a.prototype.update=function(){this.move();return this.draw()};return a}();R=function(){function d(b,a){this.x=b;this.y=a;this.burst=this.shootCooldown=this.angle=0;this.health=1}d.prototype.rand=0.005;d.prototype.threshold=45;d.prototype.width=
20;d.prototype.height=20;d.prototype.boxHit=function(b){return Math.abs(b.x-this.x)<(b.width+this.width)/2&&Math.abs(b.y-this.y)<(b.height+this.height)/2};d.prototype.draw=function(){c.translate(this.x,this.y);c.rotate(this.angle);c.beginPath();c.moveTo(-this.width/2,-this.height/2);c.lineTo(this.width/2,-this.height/2);c.lineTo(this.width/2,this.height/2);c.lineTo(-this.width/2,this.height/2);c.closePath();c.stroke();c.rotate(-this.angle);return c.translate(-this.x,-this.y)};d.prototype.move=function(){this.angle+=
0.1;return this.y+=2};d.prototype.shoot=function(){5>this.burst?this.burst+=1:(this.shootCooldown=55,this.burst=0);return a.owners.enemies.lasers.push(new r(this.x,this.y,r.prototype.speed,a.owners.enemies))};d.prototype.takeDamage=function(){var b,c,d,g;if(this.y>f.height)return this.health=0;if(this.boxHit(e))return a.owners.player.health-=24,a.owners.player.kills+=1,a.timers.dispHealth=255,this.health=0;g=a.owners.player.lasers;c=0;for(d=g.length;c<d;c++)if(b=g[c],Math.abs(this.x-b.x)<=this.width/
2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2)return b.killedSomething=!0,a.owners.player.kills+=1,this.health=0;g=a.owners.player.bombs;c=0;for(d=g.length;c<d;c++)if(b=g[c],this.boxHit(b))return b.cooldown=0,a.owners.player.kills+=1,this.health=0;g=a.owners.player.shrapnals;c=0;for(d=g.length;c<d;c++)if(b=g[c],this.boxHit(b))return a.owners.player.kills+=1,this.health=0};d.prototype.update=function(){0>=this.shootCooldown&&this.shoot();this.shootCooldown-=1;this.move();
this.draw();return this.takeDamage()};return d}();t=function(c){if(a.owners.player.kills>=c.prototype.threshold&&Math.random()<c.prototype.rand)return a.owners.enemies.units.push(new c(U(0,f.width),-10))};f=document.getElementById("c");c=f.getContext("2d");o=$("<audio></audio>").attr({loop:"loop"}).append($("<source></source>").attr({src:"media/tonight_full.ogg"}).attr({type:"audio/ogg"})).append($("<source></source>").attr({src:"media/tonight_full.mp3"}).attr({type:"audio/mpeg"})).appendTo("body")[0];
console.log(o);if(!c)throw"Loading context failed";U=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};B=function(a,b){return setInterval(b,a)};e=a=void 0;C=!0;v=250;w=200;y=x=!1;s=void 0;j="Title";E=function(){c.fillStyle="#FFFFFF";c.font="bold 20px Lucidia Console";c.textAlign="center";return c.textBaseline="middle"};V=function(){c.fillStyle="#FFFFFF";c.font="normal 18px Lucidia Console";c.textAlign="left";return c.textBaseline="bottom"};A=function(){c.fillStyle="#000000";return c.fillRect(0,
0,f.width,f.height)};J=function(){A();E();c.fillText("Tempus [Dev]",f.width/2,f.height/2-12);c.fillText("Click to play",f.width/2,f.height/2+12);V();return c.fillText("by Jake Stothard",10,f.height-10)};S=function(){A();E();c.fillText("Game Over",f.width/2,f.height/2-20);c.font="normal 18px Lucidia Console";c.fillText("Kills - "+a.owners.player.kills,f.width/2,f.height/2);c.fillText("Lasers Fired - "+a.owners.player.lasersFired,f.width/2,f.height/2+20);return c.fillText("Bombs Used - "+a.owners.player.bombsFired,
f.width/2,f.height/2+40)};c.strokeStyle="#FFFFFF";c.lineWidth=4;T=function(){$("#enableMusic")[0].checked&&o.play();return C=!1};K=function(){C&&T();e=new Q(v,w);return a={owners:{player:{lasers:[],bombs:[],shrapnals:[],units:e,color:"#0044FF",health:100,kills:0,lasersFired:0,bombsFired:0},enemies:{lasers:[],bombs:[],shrapnals:[],units:[],color:"#FF0000"}},timers:{dispHealth:0,colorCycle:0,colorCycleDir:10},powerups:{healthups:[]},crashed:!1}};I=function(){c.beginPath();c.arc(f.width/2,f.height/2,
Math.min(f.width,f.height)/2-20,0,Math.max(a.owners.player.health,0)*Math.PI/50,!1);return c.stroke()};L=function(){j="Paused";clearInterval(s);I();E();return c.fillText("[Paused]",f.width/2,f.height/2)};M=function(){j="Playing";return s=B(32,D)};$(document).keyup(function(a){switch(a.which){case 80:switch(j){case "Paused":return M();case "Playing":return L()}}});$("#c").mousemove(function(a){v=a.pageX-this.offsetLeft;return w=a.pageY-this.offsetTop}).mouseout(function(){if("Playing"===j)return L()}).mousedown(function(a){switch(a.which){case 1:return x=
!0;case 3:return y=!0}}).mouseup(function(a){switch(a.which){case 1:return x=!1;case 3:return y=!1}}).click(function(){switch(j){case "Paused":return M();case "Title":return j="Playing",K(),s=B(32,D);case void 0:return j="Title",J()}}).bind("contextmenu",function(){return!1});$("#enableMusic").change(function(){if(!C){if($("#enableMusic")[0].checked)return o.play(),!0;o.pause();return!1}});D=function(){var d,b,l,n,g,i,k,o,u,m,h,p,q;if(a.crashed)j="Crashed",clearInterval(s);else{a.crashed=!0;a.timers.colorCycle+=
a.timers.colorCycleDir;a.timers.colorCycle=Math.min(a.timers.colorCycle,255);a.timers.colorCycle=Math.max(a.timers.colorCycle,0);if(0===a.timers.colorCycle||255===a.timers.colorCycle)a.timers.colorCycleDir*=-1;if(0>=a.owners.player.health)j=void 0,clearInterval(s),S();else{A();p=a.owners.enemies.units;m=0;for(h=p.length;m<h;m++)b=p[m],b.update();a.powerups.healthups=a.powerups.healthups.concat(function(){var c,d,e,f;e=a.owners.enemies.units;f=[];c=0;for(d=e.length;c<d;c++)b=e[c],0>=b.health&&Math.random()<
G.prototype.rand&&f.push(new G(b.x,b.y));return f}());a.owners.enemies.units=function(){var c,d,e,f;e=a.owners.enemies.units;f=[];c=0;for(d=e.length;c<d;c++)b=e[c],0<b.health&&f.push(b);return f}();t(O);t(P);t(N);t(R);e.update();m=a.owners;for(g in m){n=m[g];q=n.lasers;h=0;for(p=q.length;h<p;h++)l=q[h],l.update();n.lasers=function(){var a,b,c,d,e;c=n.lasers;e=[];a=0;for(b=c.length;a<b;a++)l=c[a],0<(d=l.y)&&d<f.height&&!l.killedSomething&&e.push(l);return e}();q=n.bombs;h=0;for(p=q.length;h<p;h++)d=
q[h],d.update();n.bombs=function(){var a,b,c,e;c=n.bombs;e=[];a=0;for(b=c.length;a<b;a++)d=c[a],0<d.cooldown&&e.push(d);return e}();q=n.shrapnals;h=0;for(p=q.length;h<p;h++)u=q[h],u.update();n.shrapnals=function(){var a,b,c,d;c=n.shrapnals;d=[];b=0;for(a=c.length;b<a;b++)u=c[b],0<u.cooldown&&d.push(u);return d}()}h=a.powerups;for(o in h){k=h[o];m=0;for(g=k.length;m<g;m++)i=k[m],i.update();a.powerups[o]=function(){var a,b,c;c=[];b=0;for(a=k.length;b<a;b++)i=k[b],i.used||c.push(i);return c}()}x&&0>=
e.laserCooldown&&(a.owners.player.lasersFired+=1,a.owners.player.lasers.push(new r(e.x,e.y,-r.prototype.speed,a.owners.player)),e.laserCooldown=80<e.heat?7:40<e.heat?5:2,e.heat+=7);y&&0>=e.bombCooldown&&(a.owners.player.bombsFired+=1,"Playing"===j&&a.owners.player.bombs.push(new z(e.x,e.y,-z.prototype.speed,20,a.owners.player)),e.bombCooldown=80<e.heat?20:40<e.heat?10:5,e.heat+=10);0<e.laserCooldown&&(e.laserCooldown-=1);0<e.bombCooldown&&(e.bombCooldown-=1);0<e.heat&&(e.heat-=1);c.textAlign="center";
c.textBaseline="bottom";80<e.heat?(c.fillStyle="rgb(".concat(a.timers.colorCycle,",0,0)"),c.font="bold 20px Lucidia Console",c.fillText("[ Heat Critical ]",f.width/2,f.height-30)):40<e.heat&&(c.fillStyle="rgb(".concat(a.timers.colorCycle,",",a.timers.colorCycle,",0)"),c.font="normal 18px Lucidia Console",c.fillText("[ Heat Warning ]",f.width/2,f.height-30));0<a.timers.dispHealth&&(c.strokeStyle="rgb(".concat(a.timers.dispHealth,",",a.timers.dispHealth,",",a.timers.dispHealth,")"),I(),c.strokeStyle=
"#FFFFFF",a.timers.dispHealth-=10);return a.crashed=!1}}};switch(j){case "Playing":K();s=B(32,D);break;case "Title":J()}}).call(this);
