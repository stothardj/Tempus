(function(){var z,G,H,I,A,J,K,s,g,t,a,l,B,L,C,u,M,v,b,j,w,D,k,E,x,N,y,e,p,F;g=document.getElementById("c");a=g.getContext("2d");s=$("<audio></audio>").attr({loop:"loop"}).append($("<source><source>").attr({src:"media/tonight_full.ogg"})).appendTo("body")[0];if(!a)throw"Loading context failed";x=function(b,h){return Math.floor(Math.random()*(h-b+1))+b};u=function(b,h){return setInterval(h,b)};e=b=void 0;v=!0;k={x:250,y:200,leftDown:!1,rightDown:!1};p=void 0;j={title:"Title",gameover:"GameOver",playing:"Playing",
paused:"Paused",crashed:"Crashed"};l=j.title;z=function(){function b(h,a,f,d,c){this.x=h;this.y=a;this.speed=f;this.cooldown=d;this.owner=c}b.prototype.move=function(){return this.y+=this.speed};b.prototype.explode=function(){var b;return this.owner.shrapnals=this.owner.shrapnals.concat(function(){var a;a=[];for(b=0;b<=9;b++)a.push(new K(this.x,this.y,b*36*Math.PI/180,10,this.owner));return a}.call(this))};b.prototype.draw=function(){a.fillStyle=this.owner.color;return a.fillRect(this.x-2,this.y-
2,4,4)};b.prototype.update=function(){this.cooldown-=1;this.cooldown<=0&&this.explode();this.move();return this.draw()};return b}();G=function(){function c(b,a){this.x=b;this.y=a;this.bombCooldown=this.angle=0;this.turnVel=(Math.random()-0.5)/30}c.prototype.move=function(){this.x+=2*Math.cos(this.angle+Math.PI/2);this.y+=2*Math.sin(this.angle+Math.PI/2);this.angle+=this.turnVel;return this.goneOnScreen=0};c.prototype.draw=function(){a.translate(this.x,this.y);a.rotate(this.angle);a.beginPath();a.moveTo(0,
14);a.lineTo(5,0);a.lineTo(0,-14);a.lineTo(-5,0);a.closePath();a.stroke();a.rotate(-this.angle);return a.translate(-this.x,-this.y)};c.prototype.bomb=function(){this.bombCooldown=40;return b.owners.enemies.bombs.push(new z(this.x,this.y,4,35,b.owners.enemies))};c.prototype.update=function(){this.bombCooldown===0&&this.bomb();this.bombCooldown-=1;this.move();return this.draw()};c.prototype.alive=function(){var h,a,c,d;if(this.x<0||this.x>g.width||this.y<0||this.y>g.height){if(this.goneOnScreen)return!1}else this.goneOnScreen=
1;if(Math.abs(e.x-this.x)<25&&Math.abs(e.y-this.y)<34)return b.owners.player.health-=24,b.owners.player.kills+=1,b.timers.dispHealth=255,!1;d=b.owners.player.lasers;a=0;for(c=d.length;a<c;a++)if(h=d[a],Math.abs(this.x-h.x)<=5&&Math.abs(this.y-h.y+h.speed/2)<=(Math.abs(h.speed)+16)/2+14)return h.killedSomething=!0,b.owners.player.kills+=1,!1;d=b.owners.player.bombs;a=0;for(c=d.length;a<c;a++)if(h=d[a],Math.abs(h.x-this.x)<7&&Math.abs(h.y-this.y)<16)return h.cooldown=0,b.owners.player.kills+=1,!1;d=
b.owners.player.shrapnals;a=0;for(c=d.length;a<c;a++)if(h=d[a],Math.abs(h.x-this.x)<6&&Math.abs(h.y-this.y)<15)return b.owners.player.kills+=1,!1;return!0};return c}();H=function(){function c(b,a){this.x=b;this.y=a;this.shootCooldown=0}c.prototype.draw=function(){a.strokeStyle="#FFFFFF";a.beginPath();a.moveTo(this.x-10,this.y-10);a.lineTo(this.x+10,this.y-10);a.lineTo(this.x,this.y+10);a.closePath();return a.stroke()};c.prototype.move=function(){var b;this.y+=3;b=(e.x-this.x)/12;return this.x+=Math.abs(b)<
5?b:5*b/Math.abs(b)};c.prototype.shoot=function(){this.shootCooldown=35;return b.owners.enemies.lasers.push(new A(this.x,this.y,20,b.owners.enemies))};c.prototype.alive=function(){var a,c,f,d;if(this.y>g.height)return!1;if(Math.abs(e.x-this.x)<30&&Math.abs(e.y-this.y)<30)return b.owners.player.health-=24,b.owners.player.kills+=1,b.timers.dispHealth=255,!1;d=b.owners.player.lasers;c=0;for(f=d.length;c<f;c++)if(a=d[c],Math.abs(this.x-a.x)<=10&&Math.abs(this.y-a.y+a.speed/2)<=(Math.abs(a.speed)+16)/
2+10)return a.killedSomething=!0,b.owners.player.kills+=1,!1;d=b.owners.player.bombs;c=0;for(f=d.length;c<f;c++)if(a=d[c],Math.abs(a.x-this.x)<12&&Math.abs(a.y-this.y)<12)return a.cooldown=0,b.owners.player.kills+=1,!1;d=b.owners.player.shrapnals;c=0;for(f=d.length;c<f;c++)if(a=d[c],Math.abs(a.x-this.x)<11&&Math.abs(a.y-this.y)<11)return b.owners.player.kills+=1,!1;return!0};c.prototype.update=function(){this.shootCooldown===0&&this.shoot();this.shootCooldown-=1;this.move();return this.draw()};return c}();
I=function(){function c(a,b){this.x=a;this.y=b;this.moveState=this.shootCooldown=this.angle=0}c.prototype.move=function(){var a;switch(this.moveState){case 0:return Math.abs(this.x-e.x)<150&&Math.abs(this.y-e.y)<150?this.moveState=1:(this.angle=0,this.y+=1);case 1:return a=this.y>e.y?Math.PI-Math.atan((this.x-e.x)/(this.y-e.y)):-Math.atan((this.x-e.x)/(this.y-e.y)),Math.abs(a-this.angle)<Math.PI/24||Math.abs(a-this.angle)>Math.PI*2-Math.PI/24?(this.angle=a,this.moveState=2):this.angle<a&&this.angle-
a<Math.PI||Math.PI*2-this.angle-a<Math.PI?this.angle+=Math.PI/24:this.angle-=Math.PI/24;case 2:return this.x+=30*Math.cos(this.angle+Math.PI/2),this.y+=30*Math.sin(this.angle+Math.PI/2)}};c.prototype.draw=function(){a.translate(this.x,this.y);a.rotate(this.angle);a.beginPath();a.moveTo(-10,-10);a.lineTo(10,-10);a.lineTo(10,4);a.lineTo(0,10);a.lineTo(-10,4);a.closePath();a.stroke();a.rotate(-this.angle);return a.translate(-this.x,-this.y)};c.prototype.alive=function(){var a,c,f,d;if(this.y>g.height||
this.moveState&&(this.x<0||this.x>g.width||this.y<0||this.y>g.height))return!1;if(Math.abs(e.x-this.x)<30&&Math.abs(e.y-this.y)<30)return b.owners.player.kills+=1,b.owners.player.health-=35,b.timers.dispHealth=255,!1;d=b.owners.player.lasers;c=0;for(f=d.length;c<f;c++)if(a=d[c],Math.abs(this.x-a.x)<=10&&Math.abs(this.y-a.y+a.speed/2)<=(Math.abs(a.speed)+16)/2+10)return a.killedSomething=!0,b.owners.player.kills+=1,!1;d=b.owners.player.bombs;c=0;for(f=d.length;c<f;c++)if(a=d[c],Math.abs(a.x-this.x)<
12&&Math.abs(a.y-this.y)<12)return a.cooldown=0,b.owners.player.kills+=1,!1;d=b.owners.player.shrapnals;c=0;for(f=d.length;c<f;c++)if(a=d[c],Math.abs(a.x-this.x)<11&&Math.abs(a.y-this.y)<11)return b.owners.player.kills+=1,!1;return!0};c.prototype.update=function(){this.move();return this.draw()};return c}();A=function(){function b(a,c,f,d){this.x=a;this.y=c;this.speed=f;this.owner=d;this.killedSomething=!1}b.prototype.draw=function(){a.fillStyle=this.owner.color;return a.fillRect(this.x-1,this.y-
8,2,16)};b.prototype.move=function(){return this.y+=this.speed};b.prototype.update=function(){this.move();return this.draw()};return b}();J=function(){function c(a,b){this.x=a;this.y=b;this.heat=this.bombCooldown=this.laserCooldown=0}c.prototype.move=function(){this.x=(this.x+k.x)/2;return this.y=(this.y+k.y)/2};c.prototype.draw=function(){a.strokeStyle="#FFFFFF";a.beginPath();a.moveTo(this.x,this.y-20);a.quadraticCurveTo(this.x+20,this.y,this.x+20,this.y+20);a.quadraticCurveTo(this.x+5,this.y+10,
this.x,this.y+10);a.quadraticCurveTo(this.x-5,this.y+10,this.x-20,this.y+20);a.quadraticCurveTo(this.x-20,this.y,this.x,this.y-20);a.closePath();return a.stroke()};c.prototype.takeDamage=function(){var a,c,f,d,e;d=b.owners.enemies.lasers;c=0;for(f=d.length;c<f;c++)if(a=d[c],Math.abs(this.x-a.x)<=20&&Math.abs(this.y-a.y+a.speed/2)<=(Math.abs(a.speed)+16)/2+20)a.killedSomething=!0,b.owners.player.health-=8,b.timers.dispHealth=255;d=b.owners.enemies.bombs;c=0;for(f=d.length;c<f;c++)if(a=d[c],Math.abs(a.x-
this.x)<22&&Math.abs(a.y-this.y)<22)a.cooldown=0,b.owners.player.health-=2,b.timers.dispHealth=255;d=b.owners.enemies.shrapnals;e=[];c=0;for(f=d.length;c<f;c++)a=d[c],e.push(Math.abs(a.x-this.x)<21&&Math.abs(a.y-this.y)<21?(a.cooldown=0,b.owners.player.health-=2,b.timers.dispHealth=255):void 0);return e};c.prototype.update=function(){this.move();return this.draw()};return c}();K=function(){function b(a,c,e,d,g){this.x=a;this.y=c;this.angle=e;this.speed=d;this.owner=g;this.cooldown=10}b.prototype.move=
function(){this.x+=this.speed*Math.cos(this.angle);return this.y+=this.speed*Math.sin(this.angle)};b.prototype.draw=function(){a.fillStyle=this.owner.color;return a.fillRect(this.x-1,this.y-1,2,2)};b.prototype.update=function(){this.cooldown-=1;this.move();return this.draw()};return b}();y=function(){a.fillStyle="#FFFFFF";a.font="bold 20px Lucidia Console";a.textAlign="center";return a.textBaseline="middle"};N=function(){a.fillStyle="#FFFFFF";a.font="normal 18px Lucidia Console";a.textAlign="left";
return a.textBaseline="bottom"};t=function(){a.fillStyle="#000000";return a.fillRect(0,0,g.width,g.height)};C=function(){t();y();a.fillText("Tempus [Dev]",g.width/2,g.height/2-12);a.fillText("Click to play",g.width/2,g.height/2+12);N();return a.fillText("by Jake Stothard",10,g.height-10)};L=function(){t();y();a.fillText("Game Over",g.width/2,g.height/2-20);a.font="normal 18px Lucidia Console";a.fillText("Kills - "+b.owners.player.kills,g.width/2,g.height/2);a.fillText("Lasers Fired - "+b.owners.player.lasers_fired,
g.width/2,g.height/2+20);return a.fillText("Bombs Used - "+b.owners.player.bombs_fired,g.width/2,g.height/2+40)};a.strokeStyle="#FFFFFF";a.lineWidth=4;M=function(){$("#enableMusic")[0].checked&&s.play();return v=!1};D=function(){v&&M();e=new J(k.x,k.y);return b={owners:{player:{lasers:[],bombs:[],shrapnals:[],units:e,color:"#0044FF",health:100,kills:0,lasers_fired:0,bombs_fired:0},enemies:{lasers:[],bombs:[],shrapnals:[],units:[],color:"#FF0000"}},timers:{dispHealth:0,colorCycle:0,colorCycleDir:10},
crashed:!1}};B=function(){a.beginPath();a.arc(g.width/2,g.height/2,Math.min(g.width,g.height)/2-20,0,Math.max(b.owners.player.health,0)*Math.PI/50,!1);return a.stroke()};E=function(){l=j.paused;clearInterval(p);B();y();return a.fillText("[Paused]",g.width/2,g.height/2)};F=function(){l=j.playing;return p=u(32,w)};$(document).keyup(function(){switch(event.which){case 80:switch(l){case j.paused:return F();case j.playing:return E()}}});$("#c").mousemove(function(a){k.x=a.pageX-this.offsetLeft;return k.y=
a.pageY-this.offsetTop}).mouseout(function(){if(l===j.playing)return E()}).mousedown(function(a){switch(a.which){case 1:return k.leftDown=!0;case 3:return k.rightDown=!0}}).mouseup(function(a){switch(a.which){case 1:return k.leftDown=!1;case 3:return k.rightDown=!1}}).click(function(){switch(l){case j.paused:return F();case j.title:return l=j.playing,D(),p=u(32,w);case j.gameOver:return l=j.title,C()}}).bind("contextmenu",function(){return!1});$("#enableMusic").change(function(){if(!v)return $("#enableMusic")[0].checked?
(s.play(),!0):(s.pause(),!1)});w=function(){var c,h,q,f,d,r,i,o,m,n;if(b.crashed)l=j.crashed,clearInterval(p);else{b.crashed=!0;b.timers.colorCycle+=b.timers.colorCycleDir;b.timers.colorCycle=Math.min(b.timers.colorCycle,255);b.timers.colorCycle=Math.max(b.timers.colorCycle,0);if(b.timers.colorCycle===0||b.timers.colorCycle===255)b.timers.colorCycleDir*=-1;if(b.owners.player.health<=0)l=j.gameOver,clearInterval(p),L();else{t();m=b.owners.enemies.units;i=0;for(o=m.length;i<o;i++)h=m[i],h.update();
b.owners.enemies.units=function(){var a,c,d,e;d=b.owners.enemies.units;e=[];a=0;for(c=d.length;a<c;a++)h=d[a],h.alive()&&e.push(h);return e}();Math.random()<0.03&&b.owners.player.kills>=0&&b.owners.enemies.units.push(new H(x(0,g.width),-10));Math.random()<0.02&&b.owners.player.kills>=15&&b.owners.enemies.units.push(new I(x(0,g.width),-10));Math.random()<0.01&&b.owners.player.kills>=30&&b.owners.enemies.units.push(new G(x(0,g.width),-10));e.update();m=b.owners;for(d in m){f=m[d];n=f.lasers;i=0;for(o=
n.length;i<o;i++)q=n[i],q.update()}e.takeDamage();i=b.owners;for(d in i)f=i[d],f.lasers=function(){var a,b,c,d,e;c=f.lasers;e=[];a=0;for(b=c.length;a<b;a++)q=c[a],0<(d=q.y)&&d<g.height&&!q.killedSomething&&e.push(q);return e}();m=b.owners;for(d in m){f=m[d];n=f.bombs;i=0;for(o=n.length;i<o;i++)c=n[i],c.update()}i=b.owners;for(d in i)f=i[d],f.bombs=function(){var a,b,d,e;d=f.bombs;e=[];a=0;for(b=d.length;a<b;a++)c=d[a],c.cooldown>0&&e.push(c);return e}();m=b.owners;for(d in m){f=m[d];n=f.shrapnals;
i=0;for(o=n.length;i<o;i++)r=n[i],r.update()}i=b.owners;for(d in i)f=i[d],f.shrapnals=function(){var a,b,c,d;c=f.shrapnals;d=[];b=0;for(a=c.length;b<a;b++)r=c[b],r.cooldown>0&&d.push(r);return d}();if(k.leftDown&&e.laserCooldown<=0)b.owners.player.lasers_fired+=1,b.owners.player.lasers.push(new A(e.x,e.y,-20,b.owners.player)),e.laserCooldown=e.heat>80?7:e.heat>40?5:2,e.heat+=7;if(k.rightDown&&e.bombCooldown<=0)b.owners.player.bombs_fired+=1,l===j.playing&&b.owners.player.bombs.push(new z(e.x,e.y,
-12,20,b.owners.player)),e.bombCooldown=e.heat>80?20:e.heat>40?10:5,e.heat+=10;e.laserCooldown>0&&(e.laserCooldown-=1);e.bombCooldown>0&&(e.bombCooldown-=1);e.heat>0&&(e.heat-=1);a.textAlign="center";a.textBaseline="bottom";e.heat>80?(a.fillStyle="rgb(".concat(b.timers.colorCycle,",0,0)"),a.font="bold 20px Lucidia Console",a.fillText("[ Heat Critical ]",g.width/2,g.height-30)):e.heat>40?(a.fillStyle="rgb(".concat(b.timers.colorCycle,",",b.timers.colorCycle,",0)"),a.font="normal 18px Lucidia Console",
a.fillText("[ Heat Warning ]",g.width/2,g.height-30)):a.fillStyle="#00FF00";if(b.timers.dispHealth>0)a.strokeStyle="rgb(".concat(b.timers.dispHealth,",",b.timers.dispHealth,",",b.timers.dispHealth,")"),B(),a.strokeStyle="#FFFFFF",b.timers.dispHealth-=10;return b.crashed=!1}}};switch(l){case j.playing:D();p=u(32,w);break;case j.title:C()}}).call(this);
