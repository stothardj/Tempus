(function(){var D,E,F,w,G,H,f,s,a,m,x,I,y,t,b,j,u,z,l,A,B,J,v,c,q,C;f=document.getElementById("c");a=f.getContext("2d");if(!a)throw"Loading context failed";B=function(a,o){return Math.floor(Math.random()*(o-a+1))+a};t=function(a,o){return setInterval(o,a)};c=b=void 0;l={x:250,y:200,leftDown:!1,rightDown:!1};q=void 0;j={title:"Title",gameover:"GameOver",playing:"Playing",paused:"Paused",crashed:"Crashed"};m=j.title;G=function(){function b(o,a){this.x=o;this.y=a;this.heat=this.bombCooldown=this.laserCooldown=
0}b.prototype.move=function(){this.x=(this.x+l.x)/2;return this.y=(this.y+l.y)/2};b.prototype.draw=function(){a.strokeStyle="#FFFFFF";a.beginPath();a.moveTo(this.x,this.y-20);a.quadraticCurveTo(this.x+20,this.y,this.x+20,this.y+20);a.quadraticCurveTo(this.x+5,this.y+10,this.x,this.y+10);a.quadraticCurveTo(this.x-5,this.y+10,this.x-20,this.y+20);a.quadraticCurveTo(this.x-20,this.y,this.x,this.y-20);a.closePath();return a.stroke()};b.prototype.update=function(){this.move();return this.draw()};return b}();
E=function(){function d(a,b){this.x=a;this.y=b;this.shootCooldown=0}d.prototype.draw=function(){a.strokeStyle="#FFFFFF";a.beginPath();a.moveTo(this.x-10,this.y-10);a.lineTo(this.x+10,this.y-10);a.lineTo(this.x,this.y+10);a.closePath();return a.stroke()};d.prototype.move=function(){var a;this.y+=3;a=(c.x-this.x)/12;return this.x+=Math.abs(a)<5?a:5*a/Math.abs(a)};d.prototype.shoot=function(){this.shootCooldown=35;return b.owners.enemies.lasers.push(new w(this.x,this.y,20,b.owners.enemies))};d.prototype.alive=
function(){var a,h,d,e;if(this.y>f.height)return!1;if(Math.abs(c.x-this.x)<35&&Math.abs(c.y-this.y)<35)return b.owners.player.health-=24,b.owners.player.kills+=1,b.timers.dispHealth=255,!1;e=b.owners.player.lasers;h=0;for(d=e.length;h<d;h++)if(a=e[h],Math.abs(this.x-a.x)<=12&&Math.abs(this.y-a.y+a.speed/2)<=(Math.abs(a.speed)+16)/2+10)return a.killedSomething=!0,b.owners.player.kills+=1,!1;e=b.owners.player.bombs;h=0;for(d=e.length;h<d;h++)if(a=e[h],Math.abs(this.x-a.x)<=12&&Math.abs(this.y-a.y+a.speed/
2)<=Math.abs(a.speed)/2+12)return a.cooldown=0,b.owners.player.kills+=1,!1;e=b.owners.player.shrapnals;h=0;for(d=e.length;h<d;h++)if(a=e[h],Math.abs(this.x-a.x)<=11&&Math.abs(this.y-a.y)<=11)return b.owners.player.kills+=1,!1;return!0};d.prototype.update=function(){this.shootCooldown===0&&this.shoot();this.shootCooldown-=1;this.move();return this.draw()};return d}();F=function(){function d(a,b){this.x=a;this.y=b;this.moveState=this.shootCooldown=this.angle=0}d.prototype.move=function(){var a;switch(this.moveState){case 0:return Math.abs(this.x-
c.x)<150&&Math.abs(this.y-c.y)<150?this.moveState=1:(this.angle=0,this.y+=1);case 1:return a=this.y>c.y?Math.PI-Math.atan((this.x-c.x)/(this.y-c.y)):-Math.atan((this.x-c.x)/(this.y-c.y)),Math.abs(a-this.angle)<Math.PI/24||Math.abs(a-this.angle)>Math.PI*2-Math.PI/24?(this.angle=a,this.moveState=2):this.angle<a&&this.angle-a<Math.PI||Math.PI*2-this.angle-a<Math.PI?this.angle+=Math.PI/24:this.angle-=Math.PI/24;case 2:return this.x+=30*Math.cos(this.angle+Math.PI/2),this.y+=30*Math.sin(this.angle+Math.PI/
2)}};d.prototype.draw=function(){a.translate(this.x,this.y);a.rotate(this.angle);a.beginPath();a.moveTo(-10,-10);a.lineTo(10,-10);a.lineTo(10,4);a.lineTo(0,10);a.lineTo(-10,4);a.closePath();a.stroke();a.rotate(-this.angle);return a.translate(-this.x,-this.y)};d.prototype.alive=function(){var a,d,i,e;if(this.y>f.height||this.moveState&&(this.x<0||this.x>f.width||this.y<0))return!1;if(Math.abs(c.x-this.x)<35&&Math.abs(c.y-this.y)<35)return b.owners.player.kills+=1,b.owners.player.health-=35,b.timers.dispHealth=
255,!1;e=b.owners.player.lasers;d=0;for(i=e.length;d<i;d++)if(a=e[d],Math.abs(this.x-a.x)<=12&&Math.abs(this.y-a.y+a.speed/2)<=(Math.abs(a.speed)+16)/2+10)return a.killedSomething=!0,b.owners.player.kills+=1,!1;e=b.owners.player.bombs;d=0;for(i=e.length;d<i;d++)if(a=e[d],Math.abs(this.x-a.x)<=12&&Math.abs(this.y-a.y+a.speed/2)<=Math.abs(a.speed)/2+12)return a.cooldown=0,b.owners.player.kills+=1,!1;e=b.owners.player.shrapnals;d=0;for(i=e.length;d<i;d++)if(a=e[d],Math.abs(this.x-a.x)<=11&&Math.abs(this.y-
a.y)<=11)return b.owners.player.kills+=1,!1;return!0};d.prototype.update=function(){this.move();return this.draw()};return d}();w=function(){function b(a,d,c,e){this.x=a;this.y=d;this.speed=c;this.owner=e;this.killedSomething=!1}b.prototype.draw=function(){a.fillStyle=this.owner.color;return a.fillRect(this.x-1,this.y-8,2,16)};b.prototype.move=function(){return this.y+=this.speed};b.prototype.update=function(){this.move();return this.draw()};return b}();H=function(){function b(a,d,c,e,f){this.x=a;
this.y=d;this.angle=c;this.speed=e;this.owner=f;this.cooldown=10}b.prototype.move=function(){this.x+=this.speed*Math.cos(this.angle);return this.y+=this.speed*Math.sin(this.angle)};b.prototype.draw=function(){a.fillStyle=this.owner.color;return a.fillRect(this.x-1,this.y-1,2,2)};b.prototype.update=function(){this.cooldown-=1;this.move();return this.draw()};return b}();D=function(){function b(a,d,c,e){this.x=a;this.y=d;this.speed=c;this.owner=e;this.cooldown=20}b.prototype.move=function(){return this.y+=
this.speed};b.prototype.explode=function(){var a;return this.owner.shrapnals=this.owner.shrapnals.concat(function(){var b;b=[];for(a=0;a<=9;a++)b.push(new H(this.x,this.y,a*36*Math.PI/180,this.speed,this.owner));return b}.call(this))};b.prototype.draw=function(){a.fillStyle=this.owner.color;return a.fillRect(this.x-2,this.y-2,4,4)};b.prototype.update=function(){this.cooldown-=1;this.cooldown<=0&&this.explode();this.move();return this.draw()};return b}();v=function(){a.fillStyle="#FFFFFF";a.font="bold 20px Lucidia Console";
a.textAlign="center";return a.textBaseline="middle"};J=function(){a.fillStyle="#FFFFFF";a.font="normal 18px Lucidia Console";a.textAlign="left";return a.textBaseline="bottom"};s=function(){a.fillStyle="#000000";return a.fillRect(0,0,f.width,f.height)};y=function(){s();v();a.fillText("Tempus [Dev]",f.width/2,f.height/2-12);a.fillText("Click to play",f.width/2,f.height/2+12);J();return a.fillText("by Jake Stothard",10,f.height-10)};I=function(){s();v();a.fillText("Game Over",f.width/2,f.height/2-20);
a.font="normal 18px Lucidia Console";a.fillText("Kills - "+b.owners.player.kills,f.width/2,f.height/2);a.fillText("Lasers Fired - "+b.owners.player.lasers_fired,f.width/2,f.height/2+20);return a.fillText("Bombs Used - "+b.owners.player.bombs_fired,f.width/2,f.height/2+40)};a.strokeStyle="#FFFFFF";a.lineWidth=4;z=function(){c=new G(l.x,l.y);return b={owners:{player:{lasers:[],bombs:[],shrapnals:[],units:c,color:"#0044FF",health:100,kills:0,lasers_fired:0,bombs_fired:0},enemies:{lasers:[],bombs:[],
shrapnals:[],units:[],color:"#FF0000"}},timers:{dispHealth:0},crashed:!1}};x=function(){a.beginPath();a.arc(f.width/2,f.height/2,Math.min(f.width,f.height)/2-20,0,Math.max(b.owners.player.health,0)*Math.PI/50,!1);return a.stroke()};A=function(){m=j.paused;clearInterval(q);x();v();return a.fillText("[Paused]",f.width/2,f.height/2)};C=function(){m=j.playing;return q=t(32,u)};$(document).keyup(function(){switch(event.which){case 80:switch(m){case j.paused:return C();case j.playing:return A()}}});$("#c").mousemove(function(a){l.x=
a.pageX-this.offsetLeft;return l.y=a.pageY-this.offsetTop}).mouseout(function(){if(m===j.playing)return A()}).mousedown(function(a){console.log(a.which);switch(a.which){case 1:return l.leftDown=!0;case 3:return l.rightDown=!0}}).mouseup(function(a){console.log(a.which);switch(a.which){case 1:return l.leftDown=!1;case 3:return l.rightDown=!1}}).click(function(){switch(m){case j.paused:return C();case j.title:return m=j.playing,z(),q=t(32,u);case j.gameOver:return m=j.title,y()}}).bind("contextmenu",
function(){return!1});u=function(){var d,o,h,i,e,r,g,n,k,p;if(b.crashed)m=j.crashed,clearInterval(q);else if(b.crashed=!0,b.owners.player.health<=0)m=j.gameOver,clearInterval(q),I();else{s();k=b.owners.enemies.units;g=0;for(n=k.length;g<n;g++)o=k[g],o.update();b.owners.enemies.units=function(){var a,c,d,e;d=b.owners.enemies.units;e=[];a=0;for(c=d.length;a<c;a++)o=d[a],o.alive()&&e.push(o);return e}();Math.random()<0.05&&b.owners.enemies.units.push(new E(B(0,f.width),-10));Math.random()<0.02&&b.owners.player.kills>
15&&b.owners.enemies.units.push(new F(B(0,f.width),-10));c.update();k=b.owners;for(e in k){i=k[e];p=i.lasers;g=0;for(n=p.length;g<n;g++)h=p[g],h.update()}k=b.owners.enemies.lasers;g=0;for(n=k.length;g<n;g++)if(h=k[g],Math.abs(c.x-h.x)<=12&&Math.abs(c.y-h.y+h.speed/2)<=(Math.abs(h.speed)+16)/2+10)h.killedSomething=!0,b.owners.player.health-=8,b.timers.dispHealth=255;g=b.owners;for(e in g)i=g[e],i.lasers=function(){var a,b,c,d,e;c=i.lasers;e=[];a=0;for(b=c.length;a<b;a++)h=c[a],0<(d=h.y)&&d<f.height&&
!h.killedSomething&&e.push(h);return e}();k=b.owners;for(e in k){i=k[e];p=i.bombs;g=0;for(n=p.length;g<n;g++)d=p[g],d.update()}g=b.owners;for(e in g)i=g[e],i.bombs=function(){var a,b,c,e;c=i.bombs;e=[];b=0;for(a=c.length;b<a;b++)d=c[b],d.cooldown>0&&e.push(d);return e}();p=b.owners;for(e in p){i=p[e];k=i.shrapnals;n=0;for(g=k.length;n<g;n++)r=k[n],r.update()}g=b.owners;for(e in g)i=g[e],i.shrapnals=function(){var a,b,c,d;c=i.shrapnals;d=[];b=0;for(a=c.length;b<a;b++)r=c[b],r.cooldown>0&&d.push(r);
return d}();if(l.leftDown&&c.laserCooldown<=0)b.owners.player.lasers_fired+=1,b.owners.player.lasers.push(new w(c.x,c.y,-20,b.owners.player)),c.laserCooldown=c.heat>80?10:c.heat>40?5:2,c.heat+=7;if(l.rightDown&&c.bombCooldown<=0)b.owners.player.bombs_fired+=1,m===j.playing&&b.owners.player.bombs.push(new D(c.x,c.y,-12,b.owners.player)),c.bombCooldown=c.heat>80?20:c.heat>40?10:5,c.heat+=10;c.laserCooldown>0&&(c.laserCooldown-=1);c.bombCooldown>0&&(c.bombCooldown-=1);c.heat>0&&(c.heat-=1);a.textAlign=
"right";a.fillStyle=c.heat>80?"#FF0000":c.heat>40?"#FFFF00":"#00FF00";a.fillText("Heat: "+c.heat,f.width-10,f.height-10);if(b.timers.dispHealth>0)a.strokeStyle="rgb(".concat(b.timers.dispHealth,",",b.timers.dispHealth,",",b.timers.dispHealth,")"),x(),a.strokeStyle="#FFFFFF",b.timers.dispHealth-=10;return b.crashed=!1}};switch(m){case j.playing:z();q=t(32,u);break;case j.title:y()}}).call(this);
