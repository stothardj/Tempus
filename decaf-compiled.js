(function(){var C,D,E,x,F,G,h,r,a,m,H,y,s,c,i,t,z,u,v,A,B,w,f,p;h=document.getElementById("c");a=h.getContext("2d");if(!a)throw"Loading context failed";A=function(a,n){return Math.floor(Math.random()*(n-a+1))+a};s=function(a,n){return setInterval(n,a)};c={};u=250;v=200;p=void 0;i={title:"Title",gameover:"GameOver",playing:"Playing",paused:"Paused",crashed:"Crashed"};m=i.title;F=function(){function b(a,b){this.x=a;this.y=b}b.prototype.move=function(){this.x=(this.x+u)/2;return this.y=(this.y+v)/2};
b.prototype.draw=function(){a.strokeStyle="#FFFFFF";a.beginPath();a.moveTo(this.x,this.y-20);a.quadraticCurveTo(this.x+20,this.y,this.x+20,this.y+20);a.quadraticCurveTo(this.x+5,this.y+10,this.x,this.y+10);a.quadraticCurveTo(this.x-5,this.y+10,this.x-20,this.y+20);a.quadraticCurveTo(this.x-20,this.y,this.x,this.y-20);a.closePath();return a.stroke()};b.prototype.update=function(){this.move();return this.draw()};return b}();D=function(){function b(a,b){this.x=a;this.y=b;this.shootCooldown=0}b.prototype.draw=
function(){a.strokeStyle="#FFFFFF";a.beginPath();a.moveTo(this.x-10,this.y-10);a.lineTo(this.x+10,this.y-10);a.lineTo(this.x,this.y+10);a.closePath();return a.stroke()};b.prototype.move=function(){var a;this.y+=3;a=(f.x-this.x)/12;return this.x+=Math.abs(a)<5?a:5*a/Math.abs(a)};b.prototype.shoot=function(){this.shootCooldown=35;return c.owners.enemies.lasers.push(new x(this.x,this.y,20,c.owners.enemies))};b.prototype.alive=function(){var a,b,g,d;if(this.y>h.height)return!1;if(Math.abs(f.x-this.x)<
35&&Math.abs(f.y-this.y)<35)return c.owners.player.health-=24,!1;d=c.owners.player.lasers;b=0;for(g=d.length;b<g;b++)if(a=d[b],Math.abs(this.x-a.x)<=12&&Math.abs(this.y-a.y+a.speed/2)<=(Math.abs(a.speed)+16)/2+10)return a.killedSomething=!0,!1;d=c.owners.player.bombs;b=0;for(g=d.length;b<g;b++)if(a=d[b],Math.abs(this.x-a.x)<=12&&Math.abs(this.y-a.y+a.speed/2)<=Math.abs(a.speed)/2+12)return a.cooldown=0,!1;d=c.owners.player.shrapnals;b=0;for(g=d.length;b<g;b++)if(a=d[b],Math.abs(this.x-a.x)<=11&&Math.abs(this.y-
a.y)<=11)return!1;return!0};b.prototype.update=function(){this.shootCooldown===0&&this.shoot();this.shootCooldown-=1;this.move();return this.draw()};return b}();E=function(){function b(a,b){this.x=a;this.y=b;this.shootCooldown=this.angle=0}b.prototype.move=function(){return Math.abs(this.x-f.x)<150&&Math.abs(this.y-f.y)<150?(this.angle=this.y>f.y?Math.PI-Math.atan((this.x-f.x)/(this.y-f.y)):-Math.atan((this.x-f.x)/(this.y-f.y)),this.x+=(f.x-this.x)/4,this.y+=(f.y-this.y)/4):(this.angle=0,this.y+=
1)};b.prototype.draw=function(){a.translate(this.x,this.y);a.rotate(this.angle);a.beginPath();a.moveTo(-10,-10);a.lineTo(10,-10);a.lineTo(10,4);a.lineTo(0,10);a.lineTo(-10,4);a.closePath();a.stroke();a.rotate(-this.angle);return a.translate(-this.x,-this.y)};b.prototype.alive=function(){return!0};b.prototype.update=function(){this.move();return this.draw()};return b}();x=function(){function b(a,b,c,d){this.x=a;this.y=b;this.speed=c;this.owner=d;this.killedSomething=!1}b.prototype.draw=function(){a.fillStyle=
this.owner.color;return a.fillRect(this.x-1,this.y-8,2,16)};b.prototype.move=function(){return this.y+=this.speed};b.prototype.update=function(){this.move();return this.draw()};return b}();G=function(){function b(a,b,c,d,f){this.x=a;this.y=b;this.angle=c;this.speed=d;this.owner=f;this.cooldown=10}b.prototype.move=function(){this.x+=this.speed*Math.cos(this.angle);return this.y+=this.speed*Math.sin(this.angle)};b.prototype.draw=function(){a.fillStyle=this.owner.color;return a.fillRect(this.x-1,this.y-
1,2,2)};b.prototype.update=function(){this.cooldown-=1;this.move();return this.draw()};return b}();C=function(){function b(a,b,c,d){this.x=a;this.y=b;this.speed=c;this.owner=d;this.cooldown=20}b.prototype.move=function(){return this.y+=this.speed};b.prototype.explode=function(){var a;return this.owner.shrapnals=this.owner.shrapnals.concat(function(){var b;b=[];for(a=0;a<=9;a++)b.push(new G(this.x,this.y,a*36*Math.PI/180,this.speed,this.owner));return b}.call(this))};b.prototype.draw=function(){a.fillStyle=
this.owner.color;return a.fillRect(this.x-2,this.y-2,4,4)};b.prototype.update=function(){this.cooldown-=1;this.cooldown<=0&&this.explode();this.move();return this.draw()};return b}();w=function(){a.fillStyle="#FFFFFF";a.font="bold 20px Lucidia Console";a.textAlign="center";return a.textBaseline="middle"};B=function(){a.fillStyle="#FFFFFF";a.font="normal 18px Lucidia Console";a.textAlign="left";return a.textBaseline="bottom"};r=function(){a.fillStyle="#000000";return a.fillRect(0,0,h.width,h.height)};
y=function(){r();w();a.fillText("Tempus [Dev]",h.width/2,h.height/2-12);a.fillText("Click to play",h.width/2,h.height/2+12);B();return a.fillText("by Jake Stothard",10,h.height-10)};H=function(){r();w();return a.fillText("Game Over",h.width/2,h.height/2)};a.strokeStyle="#FFFFFF";a.lineWidth=4;f=new F(u,v);z=function(){c={owners:{player:{lasers:[],bombs:[],shrapnals:[],units:f,color:"#0044FF",health:100},enemies:{lasers:[],bombs:[],shrapnals:[],units:[],color:"#FF0000"}},crashed:!1};return c.owners.enemies.units.push(new E(A(0,
h.width),-10))};$(document).keyup(function(){switch(event.which){case 80:switch(m){case i.paused:return m=i.playing,p=s(32,t);case i.playing:return m=i.paused,clearInterval(p),w(),a.fillText("[Paused]",h.width/2,h.height/2)}}});$("#c").mousemove(function(a){u=a.pageX-this.offsetLeft;return v=a.pageY-this.offsetTop}).click(function(){switch(m){case i.playing:return c.owners.player.lasers.push(new x(f.x,f.y,-20,c.owners.player));case i.title:return m=i.playing,z(),p=s(32,t);case i.gameOver:return m=
i.title,y()}}).bind("contextmenu",function(){m===i.playing&&c.owners.player.bombs.push(new C(f.x,f.y,-12,c.owners.player));return!1});t=function(){var b,n,k,g,d,q,e,l,j,o;if(c.crashed)m=i.crashed,clearInterval(p);else if(c.crashed=!0,c.owners.player.health<=0)m=i.gameOver,clearInterval(p),H();else{r();j=c.owners.enemies.units;e=0;for(l=j.length;e<l;e++)n=j[e],n.update();c.owners.enemies.units=function(){var a,b,d,e;d=c.owners.enemies.units;e=[];a=0;for(b=d.length;a<b;a++)n=d[a],n.alive()&&e.push(n);
return e}();Math.random()<0.05&&c.owners.enemies.units.push(new D(A(0,h.width),-10));f.update();j=c.owners;for(d in j){g=j[d];o=g.lasers;e=0;for(l=o.length;e<l;e++)k=o[e],k.update()}j=c.owners.enemies.lasers;e=0;for(l=j.length;e<l;e++)if(k=j[e],Math.abs(f.x-k.x)<=12&&Math.abs(f.y-k.y+k.speed/2)<=(Math.abs(k.speed)+16)/2+10)k.killedSomething=!0,c.owners.player.health-=8;e=c.owners;for(d in e)g=e[d],g.lasers=function(){var a,b,c,d,e;c=g.lasers;e=[];a=0;for(b=c.length;a<b;a++)k=c[a],0<(d=k.y)&&d<h.height&&
!k.killedSomething&&e.push(k);return e}();j=c.owners;for(d in j){g=j[d];o=g.bombs;e=0;for(l=o.length;e<l;e++)b=o[e],b.update()}e=c.owners;for(d in e)g=e[d],g.bombs=function(){var a,c,d,e;d=g.bombs;e=[];c=0;for(a=d.length;c<a;c++)b=d[c],b.cooldown>0&&e.push(b);return e}();o=c.owners;for(d in o){g=o[d];j=g.shrapnals;l=0;for(e=j.length;l<e;l++)q=j[l],q.update()}e=c.owners;for(d in e)g=e[d],g.shrapnals=function(){var a,b,c,d;c=g.shrapnals;d=[];b=0;for(a=c.length;b<a;b++)q=c[b],q.cooldown>0&&d.push(q);
return d}();B();a.fillText("Health: "+c.owners.player.health,10,h.height-10);return c.crashed=!1}};switch(m){case i.playing:z();p=s(32,t);break;case i.title:y()}}).call(this);
