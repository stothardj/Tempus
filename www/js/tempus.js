var __t;__t=function(ns){var curr,index,part,parts,_i,_len;curr=null,parts=[].concat=ns.split(".");for(index=_i=0,_len=parts.length;_i<_len;index=++_i){part=parts[index];if(curr===null){curr=eval(part);continue}curr[part]==null?curr=curr[part]={}:curr=curr[part]}return curr},function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y={}.hasOwnProperty,Z=function(a,b){function d(){this.constructor=a}for(var c in b)Y.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};a=function(){function a(a){this.framecount=a,this.frame=0}return a.prototype.nextFrame=function(){return this.frame+=1},a.prototype.finished=function(){return this.frame>=this.framecount},a.prototype.drawFrame=function(){},a}(),e=function(){function a(a,b){this.x=a,this.y=b}return a.prototype.boxHit=function(a){return Math.abs(a.x-this.x)<(a.width+this.width)/2&&Math.abs(a.y-this.y)<(a.height+this.height)/2},a.prototype.offscreen=function(){return this.x<0||this.x>z.width||this.y<0||this.y>z.height},a.prototype.drawAsBox=function(){return B.fillRect(this.x-this.width/2,this.y-this.height/2,this.width,this.height)},a}(),h=function(a){function b(a,c){b.__super__.constructor.call(this,5),this.x=a,this.y=c}return Z(b,a),b.prototype.width=20,b.prototype.height=20,b.prototype.drawFrame=function(){return B.strokeStyle="rgba(255,0,0,".concat(1-this.frame/this.framecount,")"),B.beginPath(),B.moveTo(this.x-this.width/2-this.frame,this.y-this.height/2-this.frame),B.lineTo(this.x+this.width/2+this.frame,this.y-this.height/2-this.frame),B.lineTo(this.x,this.y+this.height/2+this.frame),B.closePath(),B.stroke()},b}(a),f=function(b){function c(a,b){this.x=a,this.y=b}return Z(c,b),c.prototype.getAnimation=function(){return new a(0)},c}(e),p=function(a){function b(a,b){this.x=a,this.y=b,this.used=0}return Z(b,a),b.prototype.move=function(){return this.y+=this.speed},b.prototype.draw=function(){return B.fillStyle=this.color,this.drawAsBox()},b.prototype.detectUse=function(){this.boxHit(V)&&(this.used=1,this.use());if(this.offscreen())return this.used=1},b.prototype.update=function(){return this.move(),this.draw(),this.detectUse()},b}(e),i="#0044FF",b="#FF0000",r=100,s=4e3,q=80,t=40,o=3,u=function(a){function b(a,c){this.x=a,this.y=c,b.__super__.constructor.call(this,this.x,this.y)}return Z(b,a),b.prototype.rand=.1,b.prototype.width=4,b.prototype.height=4,b.prototype.speed=5,b.prototype.color="#0088FF",b.prototype.use=function(){return J.owners.player.shield=Math.min(J.owners.player.shield+200,s),J.timers.dispHealth=255},b}(p),l=function(a){function b(a,b){this.x=a,this.y=b,this.angle=0,this.moveState=0,this.health=1}return Z(b,a),b.prototype.rand=.02,b.prototype.threshold=15,b.prototype.width=20,b.prototype.height=20,b.prototype.move=function(){var a;switch(this.moveState){case 0:return Math.abs(this.x-V.x)<150&&Math.abs(this.y-V.y)<150?this.moveState=1:(this.angle=0,this.y+=1);case 1:return this.y>V.y?a=Math.PI-Math.atan((this.x-V.x)/(this.y-V.y)):a=-Math.atan((this.x-V.x)/(this.y-V.y)),Math.abs(a-this.angle)<Math.PI/24||Math.abs(a-this.angle)>Math.PI*2-Math.PI/24?(this.angle=a,this.moveState=2):this.angle<a&&this.angle-a<Math.PI||Math.PI*2-this.angle-a<Math.PI?this.angle+=Math.PI/24:this.angle-=Math.PI/24;case 2:return this.x+=30*Math.cos(this.angle+Math.PI/2),this.y+=30*Math.sin(this.angle+Math.PI/2)}},b.prototype.draw=function(){return B.strokeStyle="#FFFFFF",B.translate(this.x,this.y),B.rotate(this.angle),B.beginPath(),B.moveTo(-this.width/2,-this.height/2),B.lineTo(this.width/2,-this.height/2),B.lineTo(this.width/2,this.height/5),B.lineTo(0,this.height/2),B.lineTo(-this.width/2,this.height/5),B.closePath(),B.stroke(),B.rotate(-this.angle),B.translate(-this.x,-this.y)},b.prototype.takeDamage=function(){var a,b,c,d,e,f,g,h,i,j,k,l;if(this.y>z.height||this.moveState&&this.offscreen())return this.health=0;if(this.boxHit(V))return J.owners.player.kills+=1,V.damage(35),this.health=0;j=J.owners.player.lasers;for(d=0,g=j.length;d<g;d++){b=j[d];if(Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2)return b.killedSomething=!0,J.owners.player.kills+=1,this.health=0}k=J.owners.player.bombs;for(e=0,h=k.length;e<h;e++){a=k[e];if(this.boxHit(a))return a.cooldown=0,J.owners.player.kills+=1,this.health=0}l=J.owners.player.shrapnals;for(f=0,i=l.length;f<i;f++){c=l[f];if(this.boxHit(c))return J.owners.player.kills+=1,this.health=0}},b.prototype.update=function(){return this.move(),this.draw(),this.takeDamage()},b}(f),n=function(a){function b(a,c){this.x=a,this.y=c,b.__super__.constructor.call(this,this.x,this.y)}return Z(b,a),b.prototype.rand=.02,b.prototype.width=4,b.prototype.height=4,b.prototype.speed=5,b.prototype.color="#FF9900",b.prototype.use=function(){return V.laserPower+=1},b}(p),w=function(){function a(a,b,c,d,e){this.x=a,this.y=b,this.angle=c,this.speed=d,this.owner=e,this.cooldown=10}return a.prototype.speed=10,a.prototype.width=2,a.prototype.height=2,a.prototype.drawAsBox=function(){return B.fillRect(this.x-this.width/2,this.y-this.height/2,this.width,this.height)},a.prototype.move=function(){return this.x+=this.speed*Math.cos(this.angle),this.y+=this.speed*Math.sin(this.angle)},a.prototype.draw=function(){return B.fillStyle=this.owner.color,this.drawAsBox()},a.prototype.update=function(){return this.cooldown-=1,this.move(),this.draw()},a}(),m=function(){function a(a,b,c,d){this.x=a,this.y=b,this.speed=c,this.owner=d,this.killedSomething=!1}return a.prototype.speed=20,a.prototype.width=2,a.prototype.height=16,a.prototype.drawAsBox=function(){return B.fillRect(this.x-this.width/2,this.y-this.height/2,this.width,this.height)},a.prototype.draw=function(){return B.fillStyle=this.owner.color,this.drawAsBox()},a.prototype.move=function(){return this.y+=this.speed},a.prototype.update=function(){return this.move(),this.draw()},a}(),x=function(a){function b(a,b){this.x=a,this.y=b,this.angle=0,this.shootCooldown=Math.floor(Math.random()*this.cooldownTime),this.burst=0,this.health=1}return Z(b,a),b.prototype.rand=.005,b.prototype.threshold=45,b.prototype.width=20,b.prototype.height=20,b.prototype.cooldownTime=55,b.prototype.draw=function(){return B.translate(this.x,this.y),B.rotate(this.angle),B.beginPath(),B.moveTo(-this.width/2,-this.height/2),B.lineTo(this.width/2,-this.height/2),B.lineTo(this.width/2,this.height/2),B.lineTo(-this.width/2,this.height/2),B.closePath(),B.stroke(),B.rotate(-this.angle),B.translate(-this.x,-this.y)},b.prototype.move=function(){return this.angle+=.1,this.y+=2},b.prototype.shoot=function(){return this.burst<5?this.burst+=1:(this.shootCooldown=this.cooldownTime,this.burst=0),J.owners.enemies.lasers.push(new m(this.x,this.y,m.prototype.speed,J.owners.enemies))},b.prototype.takeDamage=function(){var a,b,c,d,e,f,g,h,i,j,k,l;if(this.y>z.height)return this.health=0;if(this.boxHit(V))return V.damage(24),J.owners.player.kills+=1,this.health=0;j=J.owners.player.lasers;for(d=0,g=j.length;d<g;d++){b=j[d];if(Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2)return b.killedSomething=!0,J.owners.player.kills+=1,this.health=0}k=J.owners.player.bombs;for(e=0,h=k.length;e<h;e++){a=k[e];if(this.boxHit(a))return a.cooldown=0,J.owners.player.kills+=1,this.health=0}l=J.owners.player.shrapnals;for(f=0,i=l.length;f<i;f++){c=l[f];if(this.boxHit(c))return J.owners.player.kills+=1,this.health=0}},b.prototype.update=function(){return this.shootCooldown<=0&&this.shoot(),this.shootCooldown-=1,this.move(),this.draw(),this.takeDamage()},b}(f),j=function(){function a(){this.owners={player:{lasers:[],bombs:[],shrapnals:[],units:V,color:i,health:r,shield:0,kills:0,lasersFired:0,bombsFired:0},enemies:{lasers:[],bombs:[],shrapnals:[],units:[],color:b}},this.timers={dispHealth:0,colorCycle:0,colorCycleDir:10},this.powerups={healthups:[],laserups:[],shieldups:[]},this.animations=[],this.crashed=!1}return a}(),g=function(a){function b(a,b){this.x=a,this.y=b,this.shootCooldown=Math.floor(Math.random()*this.cooldownTime),this.health=1}return Z(b,a),b.prototype.rand=.03,b.prototype.threshold=0,b.prototype.width=20,b.prototype.height=20,b.prototype.cooldownTime=35,b.prototype.draw=function(){return B.strokeStyle="#FFFFFF",B.beginPath(),B.moveTo(this.x-this.width/2,this.y-this.height/2),B.lineTo(this.x+this.width/2,this.y-this.height/2),B.lineTo(this.x,this.y+this.height/2),B.closePath(),B.stroke()},b.prototype.move=function(){var a;return this.y+=3,a=(V.x-this.x)/12,this.x+=Math.abs(a)<5?a:5*a/Math.abs(a)},b.prototype.shoot=function(){return this.shootCooldown=this.cooldownTime,J.owners.enemies.lasers.push(new m(this.x,this.y,m.prototype.speed,J.owners.enemies))},b.prototype.takeDamage=function(){var a,b,c,d,e,f,g,h,i,j,k,l;if(this.y>z.height)return this.health=0;if(this.boxHit(V))return V.damage(24),J.owners.player.kills+=1,this.health=0;j=J.owners.player.lasers;for(d=0,g=j.length;d<g;d++){b=j[d];if(Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2)return b.killedSomething=!0,J.owners.player.kills+=1,this.health=0}k=J.owners.player.bombs;for(e=0,h=k.length;e<h;e++){a=k[e];if(this.boxHit(a))return a.cooldown=0,J.owners.player.kills+=1,this.health=0}l=J.owners.player.shrapnals;for(f=0,i=l.length;f<i;f++){c=l[f];if(this.boxHit(c))return J.owners.player.kills+=1,this.health=0}},b.prototype.update=function(){return this.shootCooldown===0&&this.shoot(),this.shootCooldown-=1,this.move(),this.draw(),this.takeDamage()},b.prototype.getAnimation=function(){return new h(this.x,this.y)},b}(f),v=function(){function a(a,b){this.x=a,this.y=b,this.laserCooldown=0,this.bombCooldown=0,this.heat=0,this.laserPower=1}return a.prototype.width=40,a.prototype.height=40,a.prototype.boxHit=function(a){return Math.abs(a.x-this.x)<(a.width+this.width)/2&&Math.abs(a.y-this.y)<(a.height+this.height)/2},a.prototype.move=function(){return this.x=(this.x+O.x)/2,this.y=(this.y+O.y)/2},a.prototype.drawShield=function(){return B.strokeStyle="rgb(0,".concat(Math.floor(J.timers.colorCycle/2),",",J.timers.colorCycle,")"),B.beginPath(),B.arc(this.x,this.y,Math.min(this.width,this.height),0,2*Math.PI,!1),B.stroke()},a.prototype.draw=function(){return J.owners.player.shield>0&&this.drawShield(),B.strokeStyle="#FFFFFF",B.beginPath(),B.moveTo(this.x,this.y-this.height/2),B.quadraticCurveTo(this.x+this.width/2,this.y,this.x+this.width/2,this.y+this.height/2),B.quadraticCurveTo(this.x+this.width/8,this.y+this.height/4,this.x,this.y+this.height/4),B.quadraticCurveTo(this.x-this.width/8,this.y+this.height/4,this.x-this.width/2,this.y+this.height/2),B.quadraticCurveTo(this.x-this.width/2,this.y,this.x,this.y-this.height/2),B.closePath(),B.stroke()},a.prototype.damage=function(a){J.timers.dispHealth=255,J.owners.player.shield-=a*20;if(J.owners.player.shield<0)return J.owners.player.health+=Math.floor(J.owners.player.shield/20),J.owners.player.shield=0},a.prototype.takeDamage=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;j=J.owners.enemies.lasers;for(d=0,g=j.length;d<g;d++)b=j[d],Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2&&(b.killedSomething=!0,this.damage(8));k=J.owners.enemies.bombs;for(e=0,h=k.length;e<h;e++)a=k[e],this.boxHit(a)&&(a.cooldown=0,this.damage(2));l=J.owners.enemies.shrapnals,m=[];for(f=0,i=l.length;f<i;f++)c=l[f],this.boxHit(c)?(c.cooldown=0,m.push(this.damage(2))):m.push(void 0);return m},a.prototype.update=function(){return this.move(),this.draw(),this.takeDamage(),J.owners.player.shield=Math.max(J.owners.player.shield-1,0)},a}(),d=function(a){function b(a,b){this.x=a,this.y=b,this.angle=0,this.bombCooldown=Math.floor(Math.random()*this.cooldownTime),this.turnVel=(Math.random()-.5)/30,this.health=1}return Z(b,a),b.prototype.rand=.01,b.prototype.threshold=30,b.prototype.width=10,b.prototype.height=28,b.prototype.cooldownTime=40,b.prototype.move=function(){return this.x+=2*Math.cos(this.angle+Math.PI/2),this.y+=2*Math.sin(this.angle+Math.PI/2),this.angle+=this.turnVel,this.goneOnScreen=0},b.prototype.draw=function(){return B.translate(this.x,this.y),B.rotate(this.angle),B.beginPath(),B.moveTo(0,this.height/2),B.lineTo(this.width/2,0),B.lineTo(0,-this.height/2),B.lineTo(-this.width/2,0),B.closePath(),B.stroke(),B.rotate(-this.angle),B.translate(-this.x,-this.y)},b.prototype.bomb=function(){return this.bombCooldown=this.cooldownTime,J.owners.enemies.bombs.push(new c(this.x,this.y,4,35,J.owners.enemies))},b.prototype.takeDamage=function(){var a,b,c,d,e,f,g,h,i,j,k,l;if(this.offscreen()){if(this.goneOnScreen)return this.health=0}else this.goneOnScreen=1;if(this.boxHit(V))return V.damage(24),J.owners.player.kills+=1,this.health=0;j=J.owners.player.lasers;for(d=0,g=j.length;d<g;d++){b=j[d];if(Math.abs(this.x-b.x)<=this.width/2&&Math.abs(this.y-b.y+b.speed/2)<=(Math.abs(b.speed)+b.height)/2+this.height/2)return b.killedSomething=!0,J.owners.player.kills+=1,this.health=0}k=J.owners.player.bombs;for(e=0,h=k.length;e<h;e++){a=k[e];if(this.boxHit(a))return a.cooldown=0,J.owners.player.kills+=1,this.health=0}l=J.owners.player.shrapnals;for(f=0,i=l.length;f<i;f++){c=l[f];if(this.boxHit(c))return J.owners.player.kills+=1,this.health=0}},b.prototype.update=function(){return this.bombCooldown===0&&this.bomb(),this.bombCooldown-=1,this.move(),this.draw(),this.takeDamage()},b}(f),k=function(a){function b(a,c){this.x=a,this.y=c,b.__super__.constructor.call(this,this.x,this.y)}return Z(b,a),b.prototype.rand=.05,b.prototype.width=4,b.prototype.height=4,b.prototype.speed=5,b.prototype.color="#00FF00",b.prototype.use=function(){return J.owners.player.health=Math.min(J.owners.player.health+15,r),J.timers.dispHealth=255},b}(p),c=function(a){function b(a,b,c,d,e){this.x=a,this.y=b,this.speed=c,this.cooldown=d,this.owner=e}return Z(b,a),b.prototype.width=4,b.prototype.height=4,b.prototype.speed=12,b.prototype.move=function(){return this.y+=this.speed},b.prototype.explode=function(){var a;return this.owner.shrapnals=this.owner.shrapnals.concat(function(){var b,c;c=[];for(a=b=0;b<=9;a=++b)c.push(new w(this.x,this.y,a*36*Math.PI/180,w.prototype.speed,this.owner));return c}.call(this))},b.prototype.draw=function(){return B.fillStyle=this.owner.color,this.drawAsBox()},b.prototype.update=function(){return this.cooldown-=1,this.cooldown<=0&&this.explode(),this.move(),this.draw()},b}(e),z=document.getElementById("c"),B=z.getContext("2d"),y=$("<audio></audio>").attr({loop:"loop"}).append($("<source></source>").attr({src:"media/tonight_full.ogg"}).attr({type:"audio/ogg"})).append($("<source></source>").attr({src:"media/tonight_full.mp3"}).attr({type:"audio/mpeg"})).appendTo("body")[0];if(!B)throw"Loading context failed";S=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},G=function(a,b){return setInterval(b,a)},Q=function(a,b){var c,d,e,f,g;b==null&&(b=function(a){return a}),e=[],d=[];for(f=0,g=a.length;f<g;f++)c=a[f],(b(c)?e:d).push(c);return[e,d]},J=void 0,V=void 0,I=!0,P=!1,O={x:250,y:200,leftDown:!1,rightDown:!1},W=void 0,K={title:"Title",gameover:"GameOver",playing:"Playing",paused:"Paused",crashed:"Crashed"},C=K.title,U=function(){return B.fillStyle="#FFFFFF",B.font="bold 20px Lucidia Console",B.textAlign="center",B.textBaseline="middle"},T=function(){return B.fillStyle="#FFFFFF",B.font="normal 18px Lucidia Console",B.textAlign="left",B.textBaseline="bottom"},A=function(){return B.fillStyle="#000000",B.fillRect(0,0,z.width,z.height)},F=function(){return A(),U(),B.fillText("Tempus [Dev]",z.width/2,z.height/2-12),B.fillText("Click to play",z.width/2,z.height/2+12),T(),B.fillText("by Jake Stothard",10,z.height-10)},E=function(){return A(),U(),B.fillText("Game Over",z.width/2,z.height/2-20),B.font="normal 18px Lucidia Console",B.fillText("Kills - "+J.owners.player.kills,z.width/2,z.height/2),B.fillText("Lasers Fired - "+J.owners.player.lasersFired,z.width/2,z.height/2+20),B.fillText("Bombs Used - "+J.owners.player.bombsFired,z.width/2,z.height/2+40)},B.strokeStyle="#FFFFFF",B.lineWidth=4,H=function(){return $("#enableMusic")[0].checked&&(y.play(),P=!0),I=!1},N=function(){return I&&H(),V=new v(O.x,O.y),J=new j},D=function(){return B.strokeStyle="rgba(0,255,0,".concat(J.timers.dispHealth/255,")"),B.beginPath(),B.arc(z.width/2,z.height/2,Math.min(z.width,z.height)/2-20,0,Math.max(J.owners.player.health,0)*Math.PI*2/r,!1),B.stroke(),B.strokeStyle="rgba(0,127,255,".concat(J.timers.dispHealth/255,")"),B.beginPath(),B.arc(z.width/2,z.height/2,Math.min(z.width,z.height)/2-40,0,Math.max(J.owners.player.shield,0)*Math.PI*2/s,!1),B.stroke()},R=function(){return C=K.paused,clearInterval(W),D(),U(),B.fillText("[Paused]",z.width/2,z.height/2)},X=function(){return C=K.playing,W=G(32,L)},$(document).keyup(function(a){switch(a.which){case 80:switch(C){case K.paused:return X();case K.playing:return R()}}}),$("#c").mousemove(function(a){return O.x=a.pageX-this.offsetLeft,O.y=a.pageY-this.offsetTop}).mouseout(function(a){if(C===K.playing)return R()}).mousedown(function(a){switch(a.which){case 1:return O.leftDown=!0;case 3:return O.rightDown=!0}}).mouseup(function(a){switch(a.which){case 1:return O.leftDown=!1;case 3:return O.rightDown=!1}}).click(function(a){switch(C){case K.paused:return X();case K.title:return C=K.playing,N(),W=G(32,L);case K.gameOver:return C=K.title,F()}}).bind("contextmenu",function(a){return!1}),$("#enableMusic").change(function(a){if(!I)return $("#enableMusic")[0].checked?(y.play(),P=!0):(y.pause(),P=!1)}),M=function(a){var b,c,d,e,f;e=J.owners.enemies.units,f=[];for(c=0,d=e.length;c<d;c++)b=e[c],b.health<=0&&Math.random()<a.prototype.rand&&f.push(new a(b.x,b.y));return f},L=function(){var a,b,e,f,h,i,j,o,p,r,s,v,w,y,F,G,H,I,L,N,P,R,T,U,X,Y,Z,$,_,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl;if(J.crashed){C=K.crashed,clearInterval(W);return}J.crashed=!0,J.timers.colorCycle+=J.timers.colorCycleDir,J.timers.colorCycle=Math.min(J.timers.colorCycle,255),J.timers.colorCycle=Math.max(J.timers.colorCycle,0);if(J.timers.colorCycle===0||J.timers.colorCycle===255)J.timers.colorCycleDir*=-1;if(J.owners.player.health<=0){C=K.gameOver,clearInterval(W),E();return}A(),bc=J.owners.enemies.units;for(F=0,L=bc.length;F<L;F++)h=bc[F],h.update();J.powerups.healthups=J.powerups.healthups.concat(M(k)),J.powerups.shieldups=J.powerups.shieldups.concat(M(u)),J.powerups.laserups=J.powerups.laserups.concat(M(n)),bd=Q(J.owners.enemies.units,function(a){return a.health>0}),J.owners.enemies.units=bd[0],f=bd[1],console.log("Bring out your dead"),console.log(f);for(G=0,N=f.length;G<N;G++)e=f[G],console.log(e.getAnimation());J.animations=J.animations.concat(function(){var a,b,c;c=[];for(a=0,b=f.length;a<b;a++)h=f[a],c.push(h.getAnimation());return c}()),J.animations=function(){var b,c,d,e;d=J.animations,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],a.finished()||e.push(a);return e}(),be=[g,l,d,x];for(H=0,P=be.length;H<P;H++)y=be[H],J.owners.player.kills>=y.prototype.threshold&&Math.random()<y.prototype.rand&&J.owners.enemies.units.push(new y(S(0,z.width),-10));V.update(),bf=J.owners;for(p in bf){o=bf[p],bg=o.lasers;for(I=0,R=bg.length;I<R;I++)j=bg[I],j.update();o.lasers=function(){var a,b,c,d,e;c=o.lasers,e=[];for(b=0,a=c.length;b<a;b++)j=c[b],0<(d=j.y)&&d<z.height&&!j.killedSomething&&e.push(j);return e}(),bh=o.bombs;for(Z=0,T=bh.length;Z<T;Z++)b=bh[Z],b.update();o.bombs=function(){var a,c,d,e;d=o.bombs,e=[];for(c=0,a=d.length;c<a;c++)b=d[c],b.cooldown>0&&e.push(b);return e}(),bi=o.shrapnals;for($=0,U=bi.length;$<U;$++)w=bi[$],w.update();o.shrapnals=function(){var a,b,c,d;c=o.shrapnals,d=[];for(b=0,a=c.length;b<a;b++)w=c[b],w.cooldown>0&&d.push(w);return d}()}bj=J.powerups;for(v in bj){s=bj[v];for(_=0,X=s.length;_<X;_++)r=s[_],r.update();J.powerups[v]=function(){var a,b,c;c=[];for(b=0,a=s.length;b<a;b++)r=s[b],r.used||c.push(r);return c}()}if(O.leftDown&&V.laserCooldown<=0){J.owners.player.lasersFired+=V.laserPower;for(i=ba=1,bk=V.laserPower;1<=bk?ba<=bk:ba>=bk;i=1<=bk?++ba:--ba)J.owners.player.lasers.push(new m(V.x+i*4-V.laserPower*2,V.y,-m.prototype.speed,J.owners.player));V.heat>q?V.laserCooldown=7:V.heat>t?V.laserCooldown=5:V.laserCooldown=2,V.heat+=7}O.rightDown&&V.bombCooldown<=0&&(J.owners.player.bombsFired+=1,C===K.playing&&J.owners.player.bombs.push(new c(V.x,V.y,-c.prototype.speed,20,J.owners.player)),V.heat>q?V.bombCooldown=20:V.heat>t?V.bombCooldown=10:V.bombCooldown=5,V.heat+=10),V.laserCooldown>0&&(V.laserCooldown-=1),V.bombCooldown>0&&(V.bombCooldown-=1),V.heat>0&&(V.heat-=1),bl=J.animations;for(bb=0,Y=bl.length;bb<Y;bb++)a=bl[bb],a.drawFrame(),a.nextFrame();return B.textAlign="center",B.textBaseline="bottom",V.heat>q?(B.fillStyle="rgb(".concat(J.timers.colorCycle,",0,0)"),B.font="bold 20px Lucidia Console",B.fillText("[ Heat Critical ]",z.width/2,z.height-30)):V.heat>t&&(B.fillStyle="rgb(".concat(J.timers.colorCycle,",",J.timers.colorCycle,",0)"),B.font="normal 18px Lucidia Console",B.fillText("[ Heat Warning ]",z.width/2,z.height-30)),J.timers.dispHealth>0&&(D(),B.strokeStyle="#FFFFFF",J.timers.dispHealth-=10),J.crashed=!1};switch(C){case K.playing:N(),W=G(32,L);break;case K.title:F()}}.call(this)